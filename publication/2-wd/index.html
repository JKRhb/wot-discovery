<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Linux version 5.7.27">
  <meta charset="utf-8">
  <meta name="generator" content="ReSpec 26.8.5">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1, shrink-to-fit=no">
  <style>
  span.example-title{text-transform:none}
  aside.example,div.example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
  div.illegal-example{color:red}
  div.illegal-example p{color:#000}
  aside.example,div.example{padding:.5em;border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
  aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
  aside.example div.example span.example-title{color:#999}
  .example pre{background-color:rgba(0,0,0,.03)}
  </style>
  <style>
  .issue-label{text-transform:initial}
  .warning>p:first-child{margin-top:0}
  .warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
  span.warning{padding:.1em .5em .15em}
  .issue.closed span.issue-number{text-decoration:line-through}
  .warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
  .warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
  li.task-list-item{list-style:none}
  input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
  .issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
  </style>
  <style>
  dfn{cursor:pointer}
  .dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
  .dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
  .dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
  .dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
  .dfn-panel *{margin:0}
  .dfn-panel b{display:block;color:#000;margin-top:.25em}
  .dfn-panel ul a[href]{color:#333}
  .dfn-panel>div{display:flex}
  .dfn-panel a.self-link{font-weight:700;margin-right:auto}
  .dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
  .dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
  .dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
  .dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
  .dfn-panel a[href]:hover{border-bottom-width:1px}
  .dfn-panel ul{padding:0}
  .dfn-panel li{margin-left:1em}
  .dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
  </style>
  <title>Web of Things (WoT) Discovery</title>
  <style type="text/css">

  a[href].internalDFN {
        color: inherit;
        border-bottom: 1px solid #99c;
        text-decoration: none;
  }
  img.wot-diagram {
    max-width: 90%;
    height: auto;
  }
  .rfc2119-assertion {
  background-color: rgb(230,230,230)
  }

  </style>
  <style id="respec-mainstyle">
  @keyframes pop{
  0%{transform:scale(1,1)}
  25%{transform:scale(1.25,1.25);opacity:.75}
  100%{transform:scale(1,1)}
  }
  .hljs{background:0 0!important}
  a abbr,h1 abbr,h2 abbr,h3 abbr,h4 abbr,h5 abbr,h6 abbr{border:none}
  dfn{font-weight:700}
  a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
  a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
  a.bibref{text-decoration:none}
  .respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
  .respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
  @supports not (text-decoration:red wavy underline){
  .respec-offending-element:not(pre){display:inline-block}
  .respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
  }
  #references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
  cite .bibref{font-style:normal}
  code{color:#c63501}
  th code{color:inherit}
  a[href].orcid{padding-left:4px;padding-right:4px}
  a[href].orcid>svg{margin-bottom:-2px}
  .toc a,.tof a{text-decoration:none}
  a .figno,a .secno{color:#000}
  ol.tof,ul.tof{list-style:none outside none}
  .caption{margin-top:.5em;font-style:italic}
  table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
  .simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
  .simple th a{color:#fff;padding:3px 5px;text-align:left}
  .simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
  .simple td{padding:3px 10px;border-top:1px solid #ddd}
  .simple tr:nth-child(even){background:#f0f6ff}
  .section dd>p:first-child{margin-top:0}
  .section dd>p:last-child{margin-bottom:0}
  .section dd{margin-bottom:1em}
  .section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
  #issue-summary>ul{column-count:2}
  #issue-summary li{list-style:none;display:inline-block}
  details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
  details.respec-tests-details>*{padding-right:2em}
  details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
  details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
  details.respec-tests-details>ul{width:100%;margin-top:-.3em}
  details.respec-tests-details>li{padding-left:1em}
  a[href].self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
  h2,h3,h4,h5,h6{position:relative}
  aside.example .marker>a.self-link{color:inherit}
  h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{border:none;color:inherit;font-size:83%;height:2em;left:-1.6em;opacity:.5;position:absolute;text-align:center;text-decoration:none;top:0;transition:opacity .2s;width:2em}
  h2>a.self-link::before,h3>a.self-link::before,h4>a.self-link::before,h5>a.self-link::before,h6>a.self-link::before{content:"§";display:block}
  @media (max-width:767px){
  dd{margin-left:0}
  h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{left:auto;top:auto}
  }
  @media print{
  .removeOnSave{display:none}
  }
  </style>
  <meta name="description" content=
  "The W3C Web of Things (WoT) is intended to enable interoperability across IoT platforms and application domains. One key mechanism for accomplishing this goal is the definition and use of metadata describing the interactions an IoT device or service makes available over the network at a suitable level of abstraction. The WoT Thing Description specification satisfies this objective.">
  <link rel="canonical" href=
  "https://www.w3.org/TR/wot-discovery/">
  <script type="application/ld+json">
  {
  "@context": [
    "http://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en-US",
      "w3p": "http://www.w3.org/2001/02pd/rec54#",
      "foaf": "http://xmlns.com/foaf/0.1/",
      "datePublished": {
        "@type": "http://www.w3.org/2001/XMLSchema#date"
      },
      "inLanguage": {
        "@language": null
      },
      "isBasedOn": {
        "@type": "@id"
      },
      "license": {
        "@type": "@id"
      }
    }
  ],
  "id": "https://www.w3.org/TR/wot-discovery/",
  "type": [
    "TechArticle"
  ],
  "name": "Web of Things (WoT) Discovery",
  "inLanguage": "en-US",
  "license": "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document",
  "datePublished": "2021-05-31",
  "copyrightHolder": {
    "name": "World Wide Web Consortium",
    "url": "https://www.w3.org/"
  },
  "discussionUrl": "https://github.com/w3c/wot-discovery/issues/",
  "alternativeHeadline": "",
  "isBasedOn": "https://www.w3.org/TR/2020/WD-wot-discovery-20201124/",
  "description": "The W3C Web of Things (WoT) is intended to enable\n           interoperability across IoT platforms and application\n           domains.  One key mechanism for accomplishing this goal\n           is the definition and use of metadata describing the\n           interactions an IoT device or service makes available\n           over the network at a suitable level of abstraction.  \n           The WoT Thing Description specification satisfies this objective.",
  "editor": [
    {
      "type": "Person",
      "name": "Andrea Cimmino",
      "worksFor": {
        "name": "Universidad Politécnica de Madrid",
        "url": "https://www.upm.es/"
      }
    },
    {
      "type": "Person",
      "name": "Michael McCool",
      "worksFor": {
        "name": "Intel Corp.",
        "url": "https://www.intel.com/"
      }
    },
    {
      "type": "Person",
      "name": "Farshid Tavakolizadeh",
      "worksFor": {
        "name": "Fraunhofer-Gesellschaft",
        "url": "https://www.fraunhofer.de/"
      }
    },
    {
      "type": "Person",
      "name": "Kunihiko Toumura",
      "worksFor": {
        "name": "Hitachi, Ltd.",
        "url": "https://www.hitachi.com/"
      }
    }
  ],
  "citation": [
    {
      "id": "https://www.w3.org/TR/wot-architecture/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Architecture",
      "url": "https://www.w3.org/TR/wot-architecture/",
      "creator": [
        {
          "name": "Matthias Kovatsch"
        },
        {
          "name": "Ryuichi Matsukura"
        },
        {
          "name": "Michael Lagally"
        },
        {
          "name": "Toru Kawaguchi"
        },
        {
          "name": "Kunihiko Toumura"
        },
        {
          "name": "Kazuo Kajimoto"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-thing-description/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Thing Description",
      "url": "https://www.w3.org/TR/wot-thing-description/",
      "creator": [
        {
          "name": "Sebastian Käbisch"
        },
        {
          "name": "Takuki Kamiya"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Victor Charpenay"
        },
        {
          "name": "Matthias Kovatsch"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/sparql11-overview/",
      "type": "TechArticle",
      "name": "SPARQL 1.1 Overview",
      "url": "https://www.w3.org/TR/sparql11-overview/",
      "creator": [
        {
          "name": "The W3C SPARQL Working Group"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://w3c.github.io/wot-usecases/",
      "type": "TechArticle",
      "name": "Web of Things (WoT): Use Cases",
      "url": "https://w3c.github.io/wot-usecases/",
      "creator": [
        {
          "name": "Michael Lagally"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Ryuichi Matsukura"
        },
        {
          "name": "Tomoaki Mizushima"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc8615",
      "type": "TechArticle",
      "name": "Well-Known Uniform Resource Identifiers (URIs)",
      "url": "https://datatracker.ietf.org/doc/html/rfc8615",
      "creator": [
        {
          "name": "M. Nottingham"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc6763",
      "type": "TechArticle",
      "name": "DNS-Based Service Discovery",
      "url": "https://datatracker.ietf.org/doc/html/rfc6763",
      "creator": [
        {
          "name": "S. Cheshire"
        },
        {
          "name": "M. Krochmal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc6762",
      "type": "TechArticle",
      "name": "Multicast DNS",
      "url": "https://datatracker.ietf.org/doc/html/rfc6762",
      "creator": [
        {
          "name": "S. Cheshire"
        },
        {
          "name": "M. Krochmal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc2782",
      "type": "TechArticle",
      "name": "A DNS RR for specifying the location of services (DNS SRV)",
      "url": "https://datatracker.ietf.org/doc/html/rfc2782",
      "creator": [
        {
          "name": "A. Gulbrandsen"
        },
        {
          "name": "P. Vixie"
        },
        {
          "name": "L. Esibov"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc6690",
      "type": "TechArticle",
      "name": "Constrained RESTful Environments (CoRE) Link Format",
      "url": "https://datatracker.ietf.org/doc/html/rfc6690",
      "creator": [
        {
          "name": "Z. Shelby"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26",
      "type": "TechArticle",
      "name": "CoRE Resource Directory",
      "url": "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26",
      "creator": [
        {
          "name": "Christian Amsüss"
        },
        {
          "name": "Zach Shelby"
        },
        {
          "name": "Michael Koster"
        },
        {
          "name": "Carsten Bormann"
        },
        {
          "name": "Peter van der Stok"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/did-core/",
      "type": "TechArticle",
      "name": "Decentralized Identifiers (DIDs) v1.0",
      "url": "https://www.w3.org/TR/did-core/",
      "creator": [
        {
          "name": "Drummond Reed"
        },
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Markus Sabadello"
        },
        {
          "name": "Dave Longley"
        },
        {
          "name": "Christopher Allen"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc7807",
      "type": "TechArticle",
      "name": "Problem Details for HTTP APIs",
      "url": "https://datatracker.ietf.org/doc/html/rfc7807",
      "creator": [
        {
          "name": "M. Nottingham"
        },
        {
          "name": "E. Wilde"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7231.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content",
      "url": "https://httpwg.org/specs/rfc7231.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/json-ld11/",
      "type": "TechArticle",
      "name": "JSON-LD 1.1",
      "url": "https://www.w3.org/TR/json-ld11/",
      "creator": [
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Pierre-Antoine Champin"
        },
        {
          "name": "Dave Longley"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc4122",
      "type": "TechArticle",
      "name": "A Universally Unique IDentifier (UUID) URN Namespace",
      "url": "https://datatracker.ietf.org/doc/html/rfc4122",
      "creator": [
        {
          "name": "P. Leach"
        },
        {
          "name": "M. Mealling"
        },
        {
          "name": "R. Salz"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc7396",
      "type": "TechArticle",
      "name": "JSON Merge Patch",
      "url": "https://datatracker.ietf.org/doc/html/rfc7396",
      "creator": [
        {
          "name": "P. Hoffman"
        },
        {
          "name": "J. Snell"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7230.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing",
      "url": "https://httpwg.org/specs/rfc7230.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7540.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol Version 2 (HTTP/2)",
      "url": "https://httpwg.org/specs/rfc7540.html",
      "creator": [
        {
          "name": "M. Belshe"
        },
        {
          "name": "R. Peon"
        },
        {
          "name": "M. Thomson, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/eventsource/",
      "type": "TechArticle",
      "name": "Server-Sent Events",
      "url": "https://www.w3.org/TR/eventsource/",
      "creator": [
        {
          "name": "Ian Hickson"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/xpath-31/",
      "type": "TechArticle",
      "name": "XML Path Language (XPath) 3.1",
      "url": "https://www.w3.org/TR/xpath-31/",
      "creator": [
        {
          "name": "Jonathan Robie"
        },
        {
          "name": "Michael Dyck"
        },
        {
          "name": "Josh Spiegel"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-discovery/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Discovery",
      "url": "https://www.w3.org/TR/wot-discovery/",
      "creator": [
        {
          "name": "Andrea Cimmino"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Farshid Tavakolizadeh"
        },
        {
          "name": "Kunihiko Toumura"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc2119",
      "type": "TechArticle",
      "name": "Key words for use in RFCs to Indicate Requirement Levels",
      "url": "https://datatracker.ietf.org/doc/html/rfc2119",
      "creator": [
        {
          "name": "S. Bradner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc8174",
      "type": "TechArticle",
      "name": "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words",
      "url": "https://datatracker.ietf.org/doc/html/rfc8174",
      "creator": [
        {
          "name": "B. Leiba"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/rfc8552",
      "type": "TechArticle",
      "name": "Scoped Interpretation of DNS Resource Records through \"Underscored\" Naming of Attribute Leaves",
      "url": "https://datatracker.ietf.org/doc/html/rfc8552",
      "creator": [
        {
          "name": "D. Crocker"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-security/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Security and Privacy Guidelines",
      "url": "https://www.w3.org/TR/wot-security/",
      "creator": [
        {
          "name": "Elena Reshetova"
        },
        {
          "name": "Michael McCool"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "type": "TechArticle",
      "name": "RESTful Design for Internet of Things Systems",
      "url": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "creator": [
        {
          "name": "Ari Keranen"
        },
        {
          "name": "Matthias Kovatsch"
        },
        {
          "name": "Klaus Hartke"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00",
      "type": "TechArticle",
      "name": "JavaScript Object Notation (JSON) Path",
      "url": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00",
      "creator": [
        {
          "name": "Glyn Normington"
        },
        {
          "name": "Edward Surov"
        },
        {
          "name": "Marko Mikulicic"
        },
        {
          "name": "Stefan Gössner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    }
  ]
  }
  </script>
  <style>
  .hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
  .hljs-comment,.hljs-quote{color:#717277;font-style:italic}
  .hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
  .hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
  .hljs-literal{color:#0b76c5}
  .hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
  .hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
  .hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
  .hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
  .hljs-emphasis{font-style:italic}
  .hljs-strong{font-weight:700}
  .hljs-link{text-decoration:underline}
  </style>
  <style>
  var{position:relative;cursor:pointer}
  var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
  var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
  var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
  var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
  </style>
  <script id="initialUserConfig" type="application/json">
  {
  "lint": {
    "check-punctuation": true,
    "local-refs-exist": true,
    "no-http-props": true,
    "no-headingless-sections": true
  },
  "doJsonLd": true,
  "specStatus": "ED",
  "shortName": "wot-discovery",
  "copyrightStart": 2017,
  "group": "wg/wot",
  "wgPublicList": "public-wot-wg",
  "github": {
    "repoURL": "https://github.com/w3c/wot-discovery",
    "branch": "master"
  },
  "previousPublishDate": "2020-11-24",
  "previousMaturity": "FPWD",
  "editors": [
    {
      "name": "Andrea Cimmino",
      "w3cid": "115672",
      "company": "Universidad Politécnica de Madrid",
      "companyURL": "https://www.upm.es/"
    },
    {
      "name": "Michael McCool",
      "w3cid": "93137",
      "company": "Intel Corp.",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Farshid Tavakolizadeh",
      "w3cid": "122520",
      "company": "Fraunhofer-Gesellschaft",
      "companyURL": "https://www.fraunhofer.de/"
    },
    {
      "name": "Kunihiko Toumura",
      "w3cid": "83488",
      "company": "Hitachi, Ltd.",
      "companyURL": "https://www.hitachi.com/"
    }
  ],
  "otherLinks": [
    {
      "key": "Participate:",
      "data": [
        {
          "value": "GitHub w3c/wot-discovery",
          "href": "https://github.com/w3c/wot-discovery/"
        },
        {
          "value": "File an issue",
          "href": "https://github.com/w3c/wot-discovery/issues/"
        },
        {
          "value": "Commit history",
          "href": "https://github.com/w3c/wot-discovery/commits/master"
        },
        {
          "value": "Pull requests",
          "href": "https://github.com/w3c/wot-discovery/pulls/"
        }
      ]
    },
    {
      "key": "Contributors",
      "data": [
        {
          "value": "In the GitHub repository",
          "href": "https://github.com/w3c/wot-discovery/graphs/contributors"
        }
      ]
    }
  ],
  "localBiblio": {
    "REST-IOT": {
      "title": "RESTful Design for Internet of Things Systems",
      "href": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "authors": [
        "Ari Keranen",
        "Matthias Kovatsch",
        "Klaus Hartke"
      ],
      "publisher": "IETF",
      "date": "11 May 2020",
      "id": "rest-iot"
    },
    "CoRE-RD": {
      "title": "CoRE Resource Directory",
      "href": "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26",
      "authors": [
        "Christian Amsüss",
        "Zach Shelby",
        "Michael Koster",
        "Carsten Bormann",
        "Peter van der Stok"
      ],
      "publisher": "IETF",
      "date": "2 November 2020",
      "id": "core-rd"
    },
    "JSONPATH": {
      "title": "JavaScript Object Notation (JSON) Path",
      "href": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00",
      "authors": [
        "Glyn Normington",
        "Edward Surov",
        "Marko Mikulicic",
        "Stefan Gössner"
      ],
      "publisher": "IETF",
      "date": "7 March 2021",
      "status": "DRAFT",
      "id": "jsonpath"
    },
    "wot-usecases": {
      "title": "Web of Things (WoT): Use Cases",
      "href": "https://w3c.github.io/wot-usecases/",
      "authors": [
        "Michael Lagally",
        "Michael McCool",
        "Ryuichi Matsukura",
        "Tomoaki Mizushima"
      ],
      "publisher": "W3C",
      "date": "15 October 2020",
      "status": "Editor's Draft",
      "id": "wot-usecases"
    }
  },
  "publishISODate": "2021-05-31T00:00:00.000Z",
  "generatedSubtitle": "Editor's Draft 31 May 2021"
  }
  </script>
  <link rel="stylesheet" href=
  "https://www.w3.org/StyleSheets/TR/2016/W3C-ED">
</head>
<body class="h-entry toc-inline">
  <div class="head">
    <a class="logo" href="https://www.w3.org/"><img alt="W3C"
    width="72" height="48" src=
    "https://www.w3.org/StyleSheets/TR/2016/logos/W3C"></a>
    <h1 id="title" class="title">Web of Things (WoT) Discovery</h1>
    <h2>W3C Editor's Draft <time class="dt-published" datetime=
    "2021-05-31">31 May 2021</time></h2>
    <dl>
      <dt>This version:</dt>
      <dd>
        <a class="u-url" href=
        "https://w3c.github.io/wot-discovery/">https://w3c.github.io/wot-discovery/</a>
      </dd>
      <dt>Latest published version:</dt>
      <dd>
        <a href=
        "https://www.w3.org/TR/wot-discovery/">https://www.w3.org/TR/wot-discovery/</a>
      </dd>
      <dt>Latest editor's draft:</dt>
      <dd>
        <a href=
        "https://w3c.github.io/wot-discovery/">https://w3c.github.io/wot-discovery/</a>
      </dd>
      <dt>Editors:</dt>
      <dd class="editor p-author h-card vcard" data-editor-id=
      "115672">
        <span class="p-name fn">Andrea Cimmino</span> (<a class=
        "p-org org h-org" href="https://www.upm.es/">Universidad
        Politécnica de Madrid</a>)
      </dd>
      <dd class="editor p-author h-card vcard" data-editor-id=
      "93137">
        <span class="p-name fn">Michael McCool</span> (<a class=
        "p-org org h-org" href="https://www.intel.com/">Intel
        Corp.</a>)
      </dd>
      <dd class="editor p-author h-card vcard" data-editor-id=
      "122520">
        <span class="p-name fn">Farshid Tavakolizadeh</span>
        (<a class="p-org org h-org" href=
        "https://www.fraunhofer.de/">Fraunhofer-Gesellschaft</a>)
      </dd>
      <dd class="editor p-author h-card vcard" data-editor-id=
      "83488">
        <span class="p-name fn">Kunihiko Toumura</span> (<a class=
        "p-org org h-org" href="https://www.hitachi.com/">Hitachi,
        Ltd.</a>)
      </dd>
      <dt>Participate:</dt>
      <dd>
        <a href="https://github.com/w3c/wot-discovery/">GitHub
        w3c/wot-discovery</a>
      </dd>
      <dd>
        <a href="https://github.com/w3c/wot-discovery/issues/">File
        an issue</a>
      </dd>
      <dd>
        <a href=
        "https://github.com/w3c/wot-discovery/commits/master">Commit
        history</a>
      </dd>
      <dd>
        <a href="https://github.com/w3c/wot-discovery/pulls/">Pull
        requests</a>
      </dd>
      <dt>Contributors</dt>
      <dd>
        <a href=
        "https://github.com/w3c/wot-discovery/graphs/contributors">In
        the GitHub repository</a>
      </dd>
    </dl>
    <p class="copyright"><a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    © 2017-2021 <a href="https://www.w3.org/"><abbr title=
    "World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
    (<a href="https://www.csail.mit.edu/"><abbr title=
    "Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title=
    "European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
    <a href="https://www.keio.ac.jp/">Keio</a>, <a href=
    "https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
    liability</a>, <a href=
    "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
    trademark</a> and <a rel="license" href=
    "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document">
    permissive document license</a> rules apply.</p>
    <hr title="Separator for header">
  </div>
  <section id="abstract" class="introductory">
    <h2>Abstract</h2>
    <p>The <abbr title="World Wide Web Consortium">W3C</abbr> Web
    of Things (WoT) is intended to enable interoperability across
    IoT platforms and application domains. One key mechanism for
    accomplishing this goal is the definition and use of metadata
    describing the interactions an IoT device or service makes
    available over the network at a suitable level of abstraction.
    The WoT Thing Description specification satisfies this
    objective.</p>
    <p>However, in order to use a Thing its Thing Description first
    has to be obtained. The <em>WoT Discovery</em> process
    described in this document addresses this problem. WoT
    Discovery needs to support the distribution of WoT Thing
    Descriptions in a variety of use cases. This includes ad-hoc
    and engineered systems; during development and at runtime; and
    on both local and global networks. The process also needs to
    work with existing discovery mechanisms, be secure, protect
    private information, and be able to efficiently handle updates
    to WoT Thing Descriptions and the dynamic and diverse nature of
    the IoT ecosystem.</p>
    <p>The WoT Discovery process is divided into two phases,
    Introduction, and Exploration. The Introduction phase leverages
    existing discovery mechanisms but does not directly expose
    metadata; they are simply used to discover Exploration
    services, which provide metadata but only after secure
    authentication and authorization. This document normatively
    defines two Exploration services, one for WoT Thing
    self-description with a single WoT Thing Description and a
    searchable WoT Thing Description Directory service for
    collections of Thing Descriptions. A variety of Introduction
    services are also described and where necessary normative
    definitions are given to support them.</p>
  </section>
  <section id="sotd" class="introductory">
    <h2>Status of This Document</h2>
    <p><em>This section describes the status of this document at
    the time of its publication. Other documents may supersede this
    document. A list of current <abbr title=
    "World Wide Web Consortium">W3C</abbr> publications and the
    latest revision of this technical report can be found in the
    <a href="https://www.w3.org/TR/"><abbr title=
    "World Wide Web Consortium">W3C</abbr> technical reports
    index</a> at https://www.w3.org/TR/.</em></p>
    <p>This document was published by the <a href=
    "https://www.w3.org/WoT/WG/">Web of Things Working Group</a> as
    an Editor's Draft.</p>
    <p><a href=
    "https://github.com/w3c/wot-discovery/issues/">GitHub
    Issues</a> are preferred for discussion of this specification.
    Alternatively, you can send comments to our mailing list.
    Please send them to <a href=
    "mailto:public-wot-wg@w3.org">public-wot-wg@w3.org</a>
    (<a href="mailto:public-wot-wg-request@w3.org?subject=subscribe">subscribe</a>,
    <a href=
    "https://lists.w3.org/Archives/Public/public-wot-wg/">archives</a>).</p>
    <p>Publication as an Editor's Draft does not imply endorsement
    by the <abbr title="World Wide Web Consortium">W3C</abbr>
    Membership.</p>
    <p>This is a draft document and may be updated, replaced or
    obsoleted by other documents at any time. It is inappropriate
    to cite this document as other than work in progress.</p>
    <p>This document was produced by a group operating under the
    <a href=
    "https://www.w3.org/Consortium/Patent-Policy-20170801/">1
    August 2017 <abbr title="World Wide Web Consortium">W3C</abbr>
    Patent Policy</a>. <abbr title=
    "World Wide Web Consortium">W3C</abbr> maintains a <a rel=
    "disclosure" href="https://www.w3.org/groups/wg/wot/ipr">public
    list of any patent disclosures</a> made in connection with the
    deliverables of the group; that page also includes instructions
    for disclosing a patent. An individual who has actual knowledge
    of a patent which the individual believes contains <a href=
    "https://www.w3.org/Consortium/Patent-Policy-20170801/#def-essential">
    Essential Claim(s)</a> must disclose the information in
    accordance with <a href=
    "https://www.w3.org/Consortium/Patent-Policy-20170801/#sec-Disclosure">
    section 6 of the <abbr title=
    "World Wide Web Consortium">W3C</abbr> Patent Policy</a>.</p>
    <p>This document is governed by the <a id=
    "w3c_process_revision" href=
    "https://www.w3.org/2020/Process-20200915/">15 September 2020
    <abbr title="World Wide Web Consortium">W3C</abbr> Process
    Document</a>.</p>
  </section>
  <nav id="toc">
    <h2 class="introductory" id="table-of-contents">Table of
    Contents</h2>
    <ol class="toc">
      <li class="tocline">
        <a class="tocxref" href="#introduction"><bdi class=
        "secno">1.</bdi> Introduction</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#conformance"><bdi class=
        "secno">2.</bdi> Conformance</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#terminology"><bdi class=
        "secno">3.</bdi> Terminology</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#architecture"><bdi class=
        "secno">4.</bdi> Architecture</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#introduction-mech"><bdi class=
        "secno">5.</bdi> Introduction Mechanisms</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#introduction-direct"><bdi class="secno">5.1</bdi>
            Direct</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#introduction-well-known"><bdi class="secno">5.2</bdi>
            Well-Known URIs</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#introduction-dns-sd"><bdi class="secno">5.3</bdi>
            DNS-Based Service Discovery</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#introduction-core-rd"><bdi class="secno">5.4</bdi>
            CoRE Link Format and CoRE Resource Directory</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href="#introduction-did"><bdi class=
            "secno">5.5</bdi> DID Documents</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#exploration-mech"><bdi class=
        "secno">6.</bdi> Exploration Mechanisms</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href="#exploration-self"><bdi class=
            "secno">6.1</bdi> Self-description</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#exploration-directory"><bdi class="secno">6.2</bdi>
            Directory</a>
            <ol class="toc">
              <li class="tocline">
                <a class="tocxref" href=
                "#exploration-directory-info"><bdi class=
                "secno">6.2.1</bdi> Information Model</a>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#exploration-directory-api"><bdi class=
                "secno">6.2.2</bdi> Directory Service API</a>
                <ol class="toc">
                  <li class="tocline">
                    <a class="tocxref" href=
                    "#exploration-directory-api-registration"><bdi class="secno">
                    6.2.2.1</bdi> Registration</a>
                    <ol class="toc">
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#exploration-directory-api-registration-creation">
                        <bdi class="secno">6.2.2.1.1</bdi>
                        Creation</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#exploration-directory-api-registration-retrieval">
                        <bdi class="secno">6.2.2.1.2</bdi>
                        Retrieval</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#exploration-directory-api-registration-update">
                        <bdi class="secno">6.2.2.1.3</bdi>
                        Update</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#exploration-directory-api-registration-deletion">
                        <bdi class="secno">6.2.2.1.4</bdi>
                        Deletion</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#exploration-directory-api-registration-listing">
                        <bdi class="secno">6.2.2.1.5</bdi>
                        Listing</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#validation"><bdi class=
                        "secno">6.2.2.1.6</bdi> Validation</a>
                      </li>
                    </ol>
                  </li>
                  <li class="tocline">
                    <a class="tocxref" href=
                    "#exploration-directory-api-management"><bdi class="secno">
                    6.2.2.2</bdi> Management</a>
                  </li>
                  <li class="tocline">
                    <a class="tocxref" href=
                    "#exploration-directory-api-notification"><bdi class="secno">
                    6.2.2.3</bdi> Notification</a>
                  </li>
                  <li class="tocline">
                    <a class="tocxref" href=
                    "#exploration-directory-api-search"><bdi class=
                    "secno">6.2.2.4</bdi> Search</a>
                    <ol class="toc">
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#jsonpath-semantic"><bdi class=
                        "secno">6.2.2.4.1</bdi> Syntactic search:
                        JSONPath</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#xpath-semantic"><bdi class=
                        "secno">6.2.2.4.2</bdi> Syntactic search:
                        XPath</a>
                      </li>
                      <li class="tocline">
                        <a class="tocxref" href=
                        "#search-semantic"><bdi class=
                        "secno">6.2.2.4.3</bdi> Semantic search:
                        SPARQL</a>
                      </li>
                    </ol>
                  </li>
                </ol>
              </li>
              <li class="tocline">
                <a class="tocxref" href=
                "#exploration-directory-security"><bdi class=
                "secno">6.2.3</bdi> Security and Privacy</a>
              </li>
            </ol>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href=
        "#security-considerations"><bdi class="secno">7.</bdi>
        Security and Privacy Considerations</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#security-consideration-ddos"><bdi class=
            "secno">7.1</bdi> Denial of Service</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#security-consideration-location-tracking"><bdi class=
            "secno">7.2</bdi> Location Tracking</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#iana-considerations"><bdi class=
        "secno">8.</bdi> IANA Considerations</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#core-resource-type"><bdi class="secno">8.1</bdi> CoRE
            Resource Types Registration</a>
          </li>
        </ol>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#changes"><bdi class=
        "secno">A.</bdi> Recent Specification Changes</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#acknowledgements"><bdi class=
        "secno">B.</bdi> Acknowledgments</a>
      </li>
      <li class="tocline">
        <a class="tocxref" href="#references"><bdi class=
        "secno">C.</bdi> References</a>
        <ol class="toc">
          <li class="tocline">
            <a class="tocxref" href=
            "#normative-references"><bdi class="secno">C.1</bdi>
            Normative references</a>
          </li>
          <li class="tocline">
            <a class="tocxref" href=
            "#informative-references"><bdi class="secno">C.2</bdi>
            Informative references</a>
          </li>
        </ol>
      </li>
    </ol>
  </nav>
  <section id="introduction">
    <h2 id="x1-introduction"><bdi class="secno">1.</bdi>
    Introduction<a class="self-link" aria-label="§" href=
    "#introduction"></a></h2>
    <p>The Web of Things (WoT) defines an architecture that
    supports the integration and use of web technologies with IoT
    devices. The WoT Architecture [<cite><a class="bibref"
    data-link-type="biblio" href="#bib-wot-architecture" title=
    "Web of Things (WoT) Architecture">wot-architecture</a></cite>]
    document defines the basic concepts and patterns of usage
    supported. However, the WoT Thing Description [<cite><a class=
    "bibref" data-link-type="biblio" href=
    "#bib-wot-thing-description" title=
    "Web of Things (WoT) Thing Description">wot-thing-description</a></cite>]
    is a key specification for WoT Discovery since it is the
    purpose of WoT Discovery to make WoT Thing Descriptions
    available. Specifically, WoT Discovery has to allow
    authenticated and authorized entities (and only those entities)
    to find WoT Thing Descriptions satisfying a set of criteria,
    such as being near a certain location, or having certain
    semantics, or containing certain interactions. Conversely, in
    order to support security and privacy objectives, the WoT
    Discovery process must not leak information to unauthorized
    entities. This includes leaking information that a given entity
    is requesting certain information, not just the information
    distributed in the Thing Descriptions themselves.</p>
    <p>There are already a number of discovery mechanisms defined,
    so we have to establish why we are proposing a new one. First,
    many existing discovery mechanisms have relatively weak
    security and privacy protections. One of our objectives is to
    establish a mechanism that not only uses best practices to
    protect metadata, but that can be upgraded to support future
    best practices as needed. Second, we are using discovery in a
    broad sense to include both local and non-local mechanisms.
    While a local mechanism might use a broadcast protocol,
    non-local mechanisms might go beyond the current network
    segment where broadcast is not scalable, and so a different
    approach, such as a search service, is needed. Our approach is
    to use existing mechanisms as needed to bootstrap into a more
    general and secure metadata distribution system. Third, the
    metadata we are distributing, the WoT Thing Description, is
    highly structured and includes rich data such as data schemas
    and semantic annotations. Existing discovery mechanisms based
    on a list of simple key-value pairs are not appropriate. At the
    same time, use of existing standards for semantic data query,
    such as SPARQL [<cite><a class="bibref" data-link-type="biblio"
    href="#bib-sparql11-overview" title=
    "SPARQL 1.1 Overview">SPARQL11-OVERVIEW</a></cite>], while
    potentially suitable for some advanced use cases, might require
    too much effort for many anticipated IoT applications.
    Therefore in order to address more basic applications, we also
    define some simpler query mechanisms.</p>
    <p>After defining some basic terminology, we will summarize the
    basic use cases and requirements for WoT Discovery. These are a
    subset of the more detailed and exhaustive use cases and
    requirements presented in the WoT Use Cases [<cite><a class=
    "bibref" data-link-type="biblio" href="#bib-wot-usecases"
    title="Web of Things (WoT): Use Cases">wot-usecases</a></cite>]
    and WoT Architecture [<cite><a class="bibref" data-link-type=
    "biblio" href="#bib-wot-architecture" title=
    "Web of Things (WoT) Architecture">wot-architecture</a></cite>]
    documents. Then we will describe the basic architecture of the
    WoT Discovery process, which uses a two-phase
    Introduction/Exploration approach. The basic goal of this
    architecture is to be able to use existing discovery standards
    to bootstrap access to protected discovery services, but to
    distribute detailed metadata only to authorized users, and to
    also protect those making queries from eavesdroppers as much as
    possible. We then describe details of specific Introduction and
    Exploration mechanisms. In particular, we define in detail a
    normative API for a WoT Thing Description Directory (WoT TDD)
    service that provides a search mechanism for collections of WoT
    Thing Descriptions that can be dynamically registered by Things
    or entities acting on their behalf. The WoT Discovery mechanism
    however also supports self-description by individual Things and
    one issue we address is how to distinguish between these two
    approaches. Finally, we discuss some security and privacy
    considerations, including a set of potential risks and
    mitigations.</p>
  </section>
  <section id="conformance">
    <h2 id="x2-conformance"><bdi class="secno">2.</bdi>
    Conformance<a class="self-link" aria-label="§" href=
    "#conformance"></a></h2>
    <p>As well as sections marked as non-normative, all authoring
    guidelines, diagrams, examples, and notes in this specification
    are non-normative. Everything else in this specification is
    normative.</p>
    <p>The key words <em class="rfc2119">MAY</em>, <em class=
    "rfc2119">MUST</em>, <em class="rfc2119">OPTIONAL</em>,
    <em class="rfc2119">RECOMMENDED</em>, and <em class=
    "rfc2119">SHOULD</em> in this document are to be interpreted as
    described in <a href=
    "https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-rfc2119" title=
    "Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>]
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-rfc8174" title=
    "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
    when, and only when, they appear in all capitals, as shown
    here.</p>
  </section>
  <section id="terminology" class="informative">
    <h2 id="x3-terminology"><bdi class="secno">3.</bdi>
    Terminology<a class="self-link" aria-label="§" href=
    "#terminology"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The fundamental WoT terminology such as <dfn id="dfn-thing"
    tabindex="0" aria-haspopup="dialog" title=
    "Show what links to this definition">Thing</dfn>, <dfn id=
    "dfn-thing-description" tabindex="0" aria-haspopup="dialog"
    title="Show what links to this definition">Thing
    Description</dfn> (<dfn id="dfn-td" tabindex="0" aria-haspopup=
    "dialog" title="Show what links to this definition">TD</dfn>),
    <dfn id="dfn-property" tabindex="0" aria-haspopup="dialog"
    title="Show what links to this definition">Property</dfn>,
    <dfn id="dfn-action" tabindex="0" aria-haspopup="dialog" title=
    "Show what links to this definition">Action</dfn>, <dfn id=
    "dfn-event" tabindex="0" aria-haspopup="dialog" title=
    "Show what links to this definition">Event</dfn> are defined in
    <a href=
    "https://www.w3.org/TR/wot-architecture/#terminology">Section
    3</a> of the WoT Architecture specification [<cite><a class=
    "bibref" data-link-type="biblio" href="#bib-wot-architecture"
    title=
    "Web of Things (WoT) Architecture">WOT-ARCHITECTURE</a></cite>].</p>
    <p>In addition, this specification introduces the following
    definitions:</p>
    <dl>
      <dt><dfn data-lt=
      "WoT Anonymous Thing Description|Anonymous TD" id=
      "dfn-wot-anonymous-thing-description" tabindex="0"
      aria-haspopup="dialog" title=
      "Show what links to this definition">Anonymous TD</dfn></dt>
      <dd>A Thing Description without an identifier
      (<code>id</code> attribute).</dd>
      <dt><dfn data-lt="WoT Discovery|Discovery" id=
      "dfn-wot-discovery" tabindex="0" aria-haspopup="dialog"
      title="Show what links to this definition">Discovery</dfn></dt>
      <dd>In the WoT context, the process of finding and retrieving
      Thing metadata in the form of Thing Descriptions for Things
      satisfying some criteria of interest.</dd>
      <dt><dfn data-lt="WoT Enriched Thing Description|Enriched TD"
      id="dfn-wot-enriched-thing-description" tabindex="0"
      aria-haspopup="dialog" title=
      "Show what links to this definition">Enriched TD</dfn></dt>
      <dd>A Thing Description embedded with additional attributes
      for bookkeeping and discovery.</dd>
      <dt><dfn data-lt="WoT Exploration|Exploration" id=
      "dfn-wot-exploration" tabindex="0" aria-haspopup="dialog"
      title=
      "Show what links to this definition">Exploration</dfn></dt>
      <dd>A discovery mechanism that provides access to detailed
      metadata in the form of one or more Thing Descriptions.
      Exploration mechanisms are in general protected by security
      mechanism and are accessible only to authorized users.</dd>
      <dt><dfn data-lt="WoT Introduction|Introduction" id=
      "dfn-wot-introduction" tabindex="0" aria-haspopup="dialog"
      title=
      "Show what links to this definition">Introduction</dfn></dt>
      <dd>A "first contact" discovery mechanism, whose result is a
      URL that references an exploration mechanism. Introduction
      mechanisms themselves should not directly provide metadata,
      and in general are designed to be open.</dd>
      <dt><dfn data-lt="WoT TDD|TDD" id="dfn-wot-tdd" tabindex="0"
      aria-haspopup="dialog" title=
      "Show what links to this definition">TDD</dfn></dt>
      <dd>Short for Thing Description Directory.</dd>
      <dt><dfn data-lt=
      "WoT Thing Description Directory|Thing Description Directory"
      id="dfn-wot-thing-description-directory" tabindex="0"
      aria-haspopup="dialog" title=
      "Show what links to this definition">Thing Description
      Directory</dfn></dt>
      <dd>A directory service with a prescribed API that allows the
      registration, management, and search of a database of Thing
      Descriptions. Note that the acronym should be TDD, not TD, to
      avoid confusion with Thing Descriptions (TDs).</dd>
      <dt><dfn data-lt="WoT Partial Thing Description|Partial TD"
      id="dfn-wot-partial-thing-description" tabindex="0"
      aria-haspopup="dialog" title=
      "Show what links to this definition">Partial TD</dfn></dt>
      <dd>A data model partially conformant to the Thing
      Description schema by including only a subset of the
      attributes.</dd>
    </dl>
  </section>
  <section id="architecture" class="informative">
    <h2 id="x4-architecture"><bdi class="secno">4.</bdi>
    Architecture<a class="self-link" aria-label="§" href=
    "#architecture"></a></h2>
    <p><em>This section is non-normative.</em></p><a href=
    "#discovery-overview" class="fig-ref" title=
    "Discovery process overview">Figure <bdi class=
    "figno">1</bdi></a> shows an overview of discovery process.
    <figure id="discovery-overview">
      <img src="images/overview.png" srcset="images/overview.svg"
      class="wot-diagram" alt="Discovery process overview">
      <figcaption>
        Figure <bdi class="figno">1</bdi> <span class=
        "fig-title">Discovery process overview</span>
      </figcaption>
    </figure>
    <div class="note" id="issue-container-generatedID">
      <div role="heading" class="ednote-title marker" id="h-ednote"
      aria-level="3">
        <span>Editor's note</span><span class="issue-label">:
        Discovery Architecture Overview</span>
      </div>
      <p class="">To do: an overview of the two-phase approach and
      its purpose, which is to support controlled and authenticated
      access to metadata by authorized users only.</p>
    </div>
  </section>
  <section id="introduction-mech" class="normative">
    <h2 id="x5-introduction-mechanisms"><bdi class="secno">5.</bdi>
    Introduction Mechanisms<a class="self-link" aria-label="§"
    href="#introduction-mech"></a></h2>
    <p>This chapter describes a mechanism for discovering a Thing
    or a <a href="#dfn-wot-thing-description-directory" class=
    "internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-wot-thing-description-directory-1">Thing
    Description Directory</a>. The following mechanism is provided
    by the Thing or the <a href=
    "#dfn-wot-thing-description-directory" class="internalDFN"
    data-link-type="dfn" id=
    "ref-for-dfn-wot-thing-description-directory-2">Thing
    Description Directory</a> so that Consumers can discover the
    Thing Description or a URL that point to the Thing
    Description.</p>
    <section id="introduction-direct" class="normative">
      <h3 id="x5-1-direct"><bdi class="secno">5.1</bdi>
      Direct<a class="self-link" aria-label="§" href=
      "#introduction-direct"></a></h3>
      <p>Any mechanism that results in a single URL. This includes
      Bluetooth beacons, QR codes, and written URLs to be typed by
      a user. <span class="rfc2119-assertion" id=
      "introduction-direct-thing-description">A request on all such
      URLs <em class="rfc2119">MUST</em> result in a TD as
      prescribed in <a href="#exploration-self" class=
      "sec-ref">§&nbsp;<bdi class="secno">6.1</bdi>
      Self-description</a>.</span> For self-describing Things, this
      can be the TD of the Thing itself. <span class=
      "rfc2119-assertion" id=
      "introduction-direct-directory-description">If the URL
      references a <a href="#dfn-wot-thing-description-directory"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-3">Thing
      Description Directory</a>, this <em class="rfc2119">MUST</em>
      be the Directory Description of the <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-4">Thing
      Description Directory</a>.</span></p>
    </section>
    <section id="introduction-well-known" class="normative">
      <h3 id="x5-2-well-known-uris"><bdi class="secno">5.2</bdi>
      Well-Known URIs<a class="self-link" aria-label="§" href=
      "#introduction-well-known"></a></h3>
      <p>A Thing or <a href="#dfn-wot-thing-description-directory"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-5">Thing
      Description Directory</a> may use the Well-Known Uniform
      Resource Identifier [<cite><a class="bibref" data-link-type=
      "biblio" href="#bib-rfc8615" title=
      "Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>]
      to advertise its presence. The Thing or <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-6">Thing
      Description Directory</a> registers its own Thing or
      Directory Description into the following path:
      <code>/.well-known/wot-thing-description</code>.</p>
      <p><span class="rfc2119-assertion" id=
      "introduction-well-known-path">When a request is made at the
      above Well-Known URI, the server <em class=
      "rfc2119">MUST</em> return a Thing Description as prescribed
      in <a href="#exploration-self" class=
      "sec-ref">§&nbsp;<bdi class="secno">6.1</bdi>
      Self-description</a>.</span></p>
      <div class="note" id="issue-container-generatedID-0">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-0" aria-level="4">
          <span>Editor's note</span><span class="issue-label">:
          Registration of Well-known URI</span>
        </div>
        <p class="">The service name in Well-Known URI
        (<code>wot-thing-description</code>) is tentative.
        "Well-Known URIs" registry and contents of registration
        request is described in Section 3.1 of [<cite><a class=
        "bibref" data-link-type="biblio" href="#bib-rfc8615" title=
        "Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>].</p>
      </div>
    </section>
    <section id="introduction-dns-sd" class="normative">
      <h3 id="x5-3-dns-based-service-discovery"><bdi class=
      "secno">5.3</bdi> DNS-Based Service Discovery<a class=
      "self-link" aria-label="§" href=
      "#introduction-dns-sd"></a></h3>
      <p>A Thing or <a href="#dfn-wot-thing-description-directory"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-7">Thing
      Description Directory</a> may use the DNS-Based Service
      Discovery (DNS-SD)[<cite><a class="bibref" data-link-type=
      "biblio" href="#bib-rfc6763" title=
      "DNS-Based Service Discovery">RFC6763</a></cite>]. This can
      be also be used to discover them on the same link by
      combining Multicast DNS (mDNS)[<cite><a class="bibref"
      data-link-type="biblio" href="#bib-rfc6762" title=
      "Multicast DNS">RFC6762</a></cite>].</p>
      <p>In DNS-SD, format of the Service Instance Name is
      <code>Instance.Service.Domain</code>. The Service part is a
      pair of labels following the conventions of [<cite><a class=
      "bibref" data-link-type="biblio" href="#bib-rfc2782" title=
      "A DNS RR for specifying the location of services (DNS SRV)">RFC2782</a></cite>].
      The first label has an underscore followed by the Service
      Name, and the second label describes the protocol.</p>
      <p><span class="rfc2119-assertion" id=
      "introduction-dns-sd-service-name">The Service Name to
      indicate the Thing or <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-8">Thing
      Description Directory</a> <em class="rfc2119">MUST</em> be
      <code>_wot</code>.</span> <span class="rfc2119-assertion" id=
      "introduction-dns-sd-service-name-directory">And the Service
      Name to indicate the <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-9">Thing
      Description Directory</a> <em class="rfc2119">MUST</em> be
      <code>_directory._sub._wot</code>.</span></p>
      <div class="note" id="issue-container-generatedID-1">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-1" aria-level="4">
          <span>Editor's note</span><span class="issue-label">:
          Service Names in existing implementations</span>
        </div>
        <p class="">The Service Names <code>_wot</code> and
        <code>_directory._sub._wot</code> are tentative. The
        following Service Names are used in the existing
        implementations: <code>_wot</code>,
        <code>_device._sub._wot</code>,
        <code>_directory._sub._wot</code>, <code>_webthing</code>,
        <code>_wot-servient</code>. To use a Service Name,
        registration to "Underscored and Globally Scoped DNS Node
        Names" Registry [<cite><a class="bibref" data-link-type=
        "biblio" href="#bib-rfc8552" title=
        "Scoped Interpretation of DNS Resource Records through &quot;Underscored&quot; Naming of Attribute Leaves">RFC8552</a></cite>]
        is required.</p>
      </div>
      <p><span class="rfc2119-assertion" id=
      "introduction-dns-sd-txt-record">In addition, the following
      information <em class="rfc2119">MUST</em> be included in the
      <code>TXT</code> record that is pointed to by the Service
      Instance Name:</span></p>
      <dl>
        <dt><code>td</code></dt>
        <dd>
          Absolute pathname of the Thing Description of the Thing
          or Directory Description of the <a href=
          "#dfn-wot-thing-description-directory" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-thing-description-directory-10">Thing
          Description Directory</a>.
        </dd>
        <dt><code>type</code></dt>
        <dd>Type of the Thing Description, i.e. <code>Thing</code>
        or <code>Directory</code>. If omitted, the type is assumed
        to be <code>Thing</code>.</dd>
      </dl>
      <div class="note" id="issue-container-generatedID-2">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-2" aria-level="4">
          <span>Editor's note</span><span class="issue-label">:
          Usage of a TXT record in existing implementations</span>
        </div>
        <p class="">The following key/value pairs are used in the
        existing implementations:<br>
        <code>retrieve</code>: Absolute path name of the API to get
        an array of Thing Description IDs from the directory
        service.<br>
        <code>register</code>: Absolute path name of the API to
        register a Directory Description with the <a href=
        "#dfn-wot-thing-description-directory" class="internalDFN"
        data-link-type="dfn" id=
        "ref-for-dfn-wot-thing-description-directory-11">Thing
        Description Directory</a>.<br>
        <code>path</code>: The URI of the thing description on the
        Web Thing's web server<br>
        <code>td</code>: Prefix of directory service API<br>
        <code>tls</code>: Value of 1 if the Web Thing supports
        connections via HTTPS.<br></p>
      </div>
      <p><a href="#sequence-dnssd-thing" class="fig-ref" title=
      "An example sequence of discovery of Thing using DNS-SD and mDNS">
      Figure <bdi class="figno">2</bdi></a> and <a href=
      "#sequence-dnssd-directory" class="fig-ref" title=
      "An example sequence of discovery of Thing Description Directory using DNS-SD and mDNS">
      Figure <bdi class="figno">3</bdi></a> shows example sequences
      of discovery of Thing and <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-12">Thing
      Description Directory</a> using DNS-SD and mDNS.</p>
      <figure id="sequence-dnssd-thing">
        <img src="images/sequence-dnssd-thing.png" srcset=
        "images/sequence-dnssd-thing.svg" class="wot-diagram" alt=
        "An example sequence of discovery of Thing using DNS-SD and mDNS">
        <figcaption>
          Figure <bdi class="figno">2</bdi> <span class=
          "fig-title">An example sequence of discovery of Thing
          using DNS-SD and mDNS</span>
        </figcaption>
      </figure>
      <figure id="sequence-dnssd-directory">
        <img src="images/sequence-dnssd-directory.png" srcset=
        "images/sequence-dnssd-directory.svg" class="wot-diagram"
        alt=
        "An example sequence of discovery of directory service using DNS-SD and mDNS">
        <figcaption>
          Figure <bdi class="figno">3</bdi> <span class=
          "fig-title">An example sequence of discovery of <a href=
          "#dfn-wot-thing-description-directory" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-thing-description-directory-13">Thing
          Description Directory</a> using DNS-SD and mDNS</span>
        </figcaption>
      </figure>
    </section>
    <section id="introduction-core-rd" class="normative">
      <h3 id="x5-4-core-link-format-and-core-resource-directory">
      <bdi class="secno">5.4</bdi> CoRE Link Format and CoRE
      Resource Directory<a class="self-link" aria-label="§" href=
      "#introduction-core-rd"></a></h3>
      <p>A Thing or <a href="#dfn-wot-thing-description-directory"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-14">Thing
      Description Directory</a> may advertise its presence using
      the Constrained RESTful Environment (CoRE) Link Format
      [<cite><a class="bibref" data-link-type="biblio" href=
      "#bib-rfc6690" title=
      "Constrained RESTful Environments (CoRE) Link Format">RFC6690</a></cite>].
      And, a Thing or <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-15">Thing
      Description Directory</a> may use the CoRE Resource Directory
      [<cite><a class="bibref" data-link-type="biblio" href=
      "#bib-core-rd" title=
      "CoRE Resource Directory">CoRE-RD</a></cite>] to register a
      link to the Thing or Directory Description.</p>
      <p><span class="rfc2119-assertion" id=
      "introduction-core-rd-resource-type-thing">The resource type
      (<code>rt</code>) of the Link that targets the Thing
      Description of the Thing <em class="rfc2119">MUST</em> be
      <code>wot.thing</code>.</span> <span class=
      "rfc2119-assertion" id=
      "introduction-core-rd-resource-type-directory">The resource
      type of the Link that targets the Directory Description of
      the <a href="#dfn-wot-thing-description-directory" class=
      "internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-16">Thing
      Description Directory</a> <em class="rfc2119">MUST</em> be
      <code>wot.directory</code>.</span></p>
      <div class="note" id="issue-container-generatedID-3">
        <div role="heading" class="ednote-title marker" id=
        "h-ednote-3" aria-level="4">
          <span>Editor's note</span>
        </div>
        <p class="">The resource types <code>wot.thing</code> and
        <code>wot.directory</code> are tentative. See also <a href=
        "#iana-considerations" class="sec-ref">§&nbsp;<bdi class=
        "secno">8.</bdi> IANA Considerations</a>.</p>
      </div>
    </section>
    <section id="introduction-did" class="normative">
      <h3 id="x5-5-did-documents"><bdi class="secno">5.5</bdi> DID
      Documents<a class="self-link" aria-label="§" href=
      "#introduction-did"></a></h3>
      <p>A Thing or <a href="#dfn-wot-thing-description-directory"
      class="internalDFN" data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-17">Thing
      Description Directory</a> may advertise its presence using
      the Decentralized Identifier (DID) [<cite><a class="bibref"
      data-link-type="biblio" href="#bib-did-core" title=
      "Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>].</p>
      <p><span class="rfc2119-assertion" id=
      "introduction-did-service-endpoint">The DID Document obtained
      by resolving the DID of a Thing or <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-18">Thing
      Description Directory</a> <em class="rfc2119">MUST</em>
      contains a Service Endpoint which point to Thing Description
      of the Thing or Directory Description of the <a href=
      "#dfn-wot-thing-description-directory" class="internalDFN"
      data-link-type="dfn" id=
      "ref-for-dfn-wot-thing-description-directory-19">Thing
      Description Directory</a>.</span></p>
      <aside class="example" id=
      "example-1-a-example-service-endpoint-in-a-did-document">
        <div class="marker">
          <a class="self-link" href=
          "#example-1-a-example-service-endpoint-in-a-did-document">
          Example <bdi>1</bdi></a><span class="example-title">: A
          Example Service Endpoint in a DID Document</span>
        </div>
        <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"service"</span>: [{
        <span class="hljs-attr">"id"</span>: <span class=
"hljs-string">"did:example:wotdiscoveryexample#td"</span>,
        <span class="hljs-attr">"type"</span>: <span class=
"hljs-string">"WotThingDescription"</span>,
        <span class="hljs-attr">"serviceEndpoint"</span>:
            <span class=
"hljs-string">"https://wot.example.com/.well-known/wot-thing-description"</span>
    }]
}</code></pre>
      </aside>
      <div class="issue" id="issue-container-number-65">
        <div role="heading" class="issue-title marker" id="h-issue"
        aria-level="4">
          <a href=
          "https://github.com/w3c/wot-discovery/issues/65"><span class="issue-number">
          Issue 65</span></a><span class="issue-label" aria-label=
          "This issue is labelled as DID.">: Create typed links in
          DID Documents for WoT Directories <a class=
          "respec-gh-label" href=
          "https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22DID%22"
          style=
          "background-color: rgb(252, 201, 146); color: rgb(0, 0, 0);">
          DID</a></span>
        </div>
        <p>These should be consistent with a general model that we
        should also use for similar things, i.e. CoRE-RD and
        DNS-SD. We should discuss with DID the process for how to
        document a link type for use in DID Documents.</p>
      </div>
    </section>
  </section>
  <section id="exploration-mech" class="normative">
    <h2 id="x6-exploration-mechanisms"><bdi class="secno">6.</bdi>
    Exploration Mechanisms<a class="self-link" aria-label="§" href=
    "#exploration-mech"></a></h2>
    <div class="note" id="issue-container-generatedID-4">
      <div role="heading" class="ednote-title marker" id=
      "h-ednote-4" aria-level="3">
        <span>Editor's note</span><span class="issue-label">:
        Exploration Mechanism Overview</span>
      </div>
      <p class="">To do: Description of supported explorations, and
      requirements for new exploration mechanisms.</p>
    </div><a href="#exploration-class-diagram" class="fig-ref"
    title=
    "The high-level class diagram of the exploration mechanisms">Figure
    <bdi class="figno">4</bdi></a> depicts the high-level
    information model for self-describing and directory services.
    These exploration mechanisms are described in <a href=
    "#exploration-self" class="sec-ref">§&nbsp;<bdi class=
    "secno">6.1</bdi> Self-description</a> and <a href=
    "#exploration-directory" class="sec-ref">§&nbsp;<bdi class=
    "secno">6.2</bdi> Directory</a>.
    <figure id="exploration-class-diagram">
      <img src="images/exploration-class-diagram.svg" class=
      "wot-diagram" alt=
      "Exploration mechanisms high-level class diagram" height=
      "360" width="441">
      <figcaption>
        Figure <bdi class="figno">4</bdi> <span class=
        "fig-title">The high-level class diagram of the exploration
        mechanisms</span>
      </figcaption>
    </figure>The <a href="#dfn-wot-thing-description-directory"
    class="internalDFN" data-link-type="dfn" id=
    "ref-for-dfn-wot-thing-description-directory-20">Thing
    Description Directory</a> ontology defines two new Thing
    Description classes that may be used to model special
    exploratory metadata:
    <dl>
      <dt>Directory Description</dt>
      <dd>
        A TD which describes a directory instance. <span class=
        "rfc2119-assertion" id=
        "exploration-directory-description-type">The Directory
        Description <em class="rfc2119">MUST</em> use type
        <code>DirectoryDescription</code> from the discovery
        context or URI
        <code>https://www.w3.org/2021/wot/discovery#DirectoryDescription</code>.</span>
        <p><a href="#directory-thing-description" class=
        "box-ref">Example <bdi>3</bdi></a> which describes the API
        of the Thing Description Directory is an example of this TD
        type.</p>
      </dd>
      <dt>Link Description</dt>
      <dd>
        A TD which describes a reference to another TD.
        <span class="rfc2119-assertion" id=
        "exploration-link-description-type">The Link Description
        <em class="rfc2119">MUST</em> use type
        <code>LinkDescription</code> from the discovery context or
        URI
        <code>https://www.w3.org/2021/wot/discovery#LinkDescription</code>.</span>
        <span class="rfc2119-assertion" id=
        "exploration-link-description-link">The Link Description
        <em class="rfc2119">MUST</em> define the reference TD as a
        Link with <code>describedby</code> link relation type,
        <code>application/td+json</code> media type and
        <code>href</code> set to the target URL.</span>
        <p><a href="#example-td-link-type" class="box-ref">Example
        <bdi>2</bdi></a> is an example Link Description.</p>
        <aside class="example" id="example-td-link-type">
          <div class="marker">
            <a class="self-link" href=
            "#example-td-link-type">Example
            <bdi>2</bdi></a><span class="example-title">: Example
            Link Description</span>
          </div>
          <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class=
"hljs-string">"https://www.w3.org/2019/wot/td/v1"</span>,
        <span class=
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"@type"</span>: <span class=
"hljs-string">"LinkDescription"</span>,
    <span class="hljs-attr">"id"</span>: <span class=
"hljs-string">"urn:example:link"</span>,
    <span class="hljs-attr">"links"</span>: [{
        <span class="hljs-attr">"rel"</span>: <span class=
"hljs-string">"describedby"</span>,
        <span class="hljs-attr">"href"</span>: <span class=
"hljs-string">"https://example.com/td.jsonld"</span>,
        <span class="hljs-attr">"type"</span>: <span class=
"hljs-string">"application/td+json"</span>
    }],
    <span class="hljs-attr">"security"</span>: <span class=
"hljs-string">"basic_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"basic_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"basic"</span>
        }
    },
    <span class="hljs-attr">"title"</span>: <span class=
"hljs-string">"Example TD referencing another"</span>
}</code></pre>
        </aside>
      </dd>
      <dd>
        <div class="issue closed" id="issue-container-number-54">
          <div role="heading" class="issue-title marker" id=
          "h-issue-0" aria-level="3">
            <a href=
            "https://github.com/w3c/wot-discovery/issues/54"><span class="issue-number">
            Issue 54</span></a><span class="issue-label">: Need to
            define the discovery types and vocabulary</span>
          </div>
          <p class="">The context and type URIs are tentative and
          subject to change.</p>
        </div>
        <section id="exploration-self" class="normative">
          <h3 id="x6-1-self-description"><bdi class=
          "secno">6.1</bdi> Self-description<a class="self-link"
          aria-label="§" href="#exploration-self"></a></h3>
          <p>The self-description is an exploration mechanism in
          which a <a href="#dfn-thing" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-thing-1">Thing</a>
          hosts its own <a href="#dfn-td" class="internalDFN"
          data-link-type="dfn" id="ref-for-dfn-td-1">TD</a> and
          exposes it at a URL or through others means. If exposed
          at a URL (e.g. over HTTP or CoAP), the URL may be
          advertised via one of the <a href="#introduction-mech"
          class="sec-ref">§&nbsp;<bdi class="secno">5.</bdi>
          Introduction Mechanisms</a>. The hosted TD may also be
          registered inside a <a href=
          "#dfn-wot-thing-description-directory" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-thing-description-directory-21">Thing
          Description Directory</a> as prescribed in <a href=
          "#exploration-directory" class=
          "sec-ref">§&nbsp;<bdi class="secno">6.2</bdi>
          Directory</a>.</p>The self-description using the
          following protocols must be according to the given
          specification:
          <dl>
            <dt>HTTP</dt>
            <dd>
              <p><span class="rfc2119-assertion" id=
              "self-http-secure">The HTTP-based self-description
              <em class="rfc2119">SHOULD</em> be over HTTPS (HTTP
              Over TLS).</span> <span class="rfc2119-assertion" id=
              "self-http-method">The HTTP server <em class=
              "rfc2119">MUST</em> serve the TD with a
              <code>GET</code> method.</span> <span class=
              "rfc2119-assertion" id="self-http-resp">A successful
              response <em class="rfc2119">MUST</em> have 200 (OK)
              status, contain <code>application/td+json</code>
              Content-Type header, and the TD in body.</span>
              <span class="rfc2119-assertion" id=
              "self-http-alternate-content">The server <em class=
              "rfc2119">MAY</em> provide alternative
              representations through server-driven content
              negotiation, that is by honouring the request's
              Accept header and responding with the supported TD
              serialization and equivalent Content-Type
              header.</span> <span class="rfc2119-assertion" id=
              "self-http-access-control">The server <em class=
              "rfc2119">SHOULD</em> serve the requests after
              performing necessary authentication and
              authorization.</span></p>
              <p>Error responses:</p>
              <ul>
                <li>401 (Unauthorized): No authentication.</li>
                <li>403 (Forbidden): Insufficient rights to the
                resource.</li>
              </ul>
            </dd>
          </dl>
        </section>
        <section id="exploration-directory" class="normative">
          <h3 id="x6-2-directory"><bdi class="secno">6.2</bdi>
          Directory<a class="self-link" aria-label="§" href=
          "#exploration-directory"></a></h3>
          <div class="note" id="issue-container-generatedID-5">
            <div role="heading" class="ednote-title marker" id=
            "h-ednote-5" aria-level="4">
              <span>Editor's note</span><span class="issue-label">:
              Directory Overview</span>
            </div>
            <p class="">To do: Describe mechanisms for TDs to be
            hosted in a searchable directory service.</p>
          </div>
          <section id="exploration-directory-info" class=
          "normative">
            <h4 id="x6-2-1-information-model"><bdi class=
            "secno">6.2.1</bdi> Information Model<a class=
            "self-link" aria-label="§" href=
            "#exploration-directory-info"></a></h4>
            <div class="note" id="issue-container-generatedID-6">
              <div role="heading" class="ednote-title marker" id=
              "h-ednote-6" aria-level="5">
                <span>Editor's note</span><span class=
                "issue-label">: Directory Information Model</span>
              </div>
              <p class="">To Do: Formal definition of information
              contained in a directory and its organization.</p>
            </div>
          </section>
          <figure id="directory-td-class-diagram">
            <img src="images/directory-td-class-diagram.svg" class=
            "wot-diagram" alt=
            "The ontology of a TD stored in a TDD" height="288"
            width="454">
            <figcaption>
              Figure <bdi class="figno">5</bdi> <span class=
              "fig-title">The ontology of a <a href="#dfn-td"
              class="internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-td-2">TD</a> that can be stored in a
              <a href="#dfn-wot-thing-description-directory" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-wot-thing-description-directory-22">Thing
              Description Directory</a>.</span>
            </figcaption>
          </figure>
          <p>As shown in <a href="#exploration-class-diagram"
          class="fig-ref" title=
          "The high-level class diagram of the exploration mechanisms">
          Figure <bdi class="figno">4</bdi></a>, the <a href=
          "#dfn-wot-thing-description-directory" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-wot-thing-description-directory-23">Thing
          Description Directory</a> can contain zero or more
          <a href="#dfn-td" class="internalDFN" data-link-type=
          "dfn" id="ref-for-dfn-td-3">TD</a>s. For every TD, the
          directory may additionally maintain the registration
          information for bookkeeping and search purposes. When
          available, consumers may request the registration
          information via the respective API. A TD which embeds the
          registration information is called an <a href=
          "#dfn-wot-enriched-thing-description" class="internalDFN"
          data-link-type="dfn" id=
          "ref-for-dfn-wot-enriched-thing-description-1">Enriched
          TD</a>. The ontology of a <a href="#dfn-td" class=
          "internalDFN" data-link-type="dfn" id=
          "ref-for-dfn-td-4">TD</a> maintained by the directory is
          illustrated in <a href="#directory-td-class-diagram"
          class="fig-ref" title=
          "The ontology of a TD that can be stored in a Thing Description Directory.">
          Figure <bdi class="figno">5</bdi></a>.</p>
          <section id="exploration-directory-api" class=
          "normative">
            <h4 id="x6-2-2-directory-service-api"><bdi class=
            "secno">6.2.2</bdi> Directory Service API<a class=
            "self-link" aria-label="§" href=
            "#exploration-directory-api"></a></h4>The Directory
            APIs must use secure protocols guaranteeing <a href=
            "https://www.w3.org/TR/wot-security/#dfn-system-user-data">
            System User Data</a> authenticity and confidentiality
            (see [<cite><a class="bibref" data-link-type="biblio"
            href="#bib-wot-security" title=
            "Web of Things (WoT) Security and Privacy Guidelines">WOT-SECURITY</a></cite>]).
            <span class="rfc2119-assertion" id="tdd-https">The HTTP
            API <em class="rfc2119">MUST</em> be exposed over HTTPS
            (HTTP Over TLS).</span>
            <p>The HTTP API responses must use appropriate status
            codes described in this section for success and error
            responses. <span class="rfc2119-assertion" id=
            "tdd-http-errors">The HTTP API <em class=
            "rfc2119">MUST</em> use the Problem Details
            [<cite><a class="bibref" data-link-type="biblio" href=
            "#bib-rfc7807" title=
            "Problem Details for HTTP APIs">RFC7807</a></cite>]
            format to carry error details in HTTP client error
            (4xx) and server error (5xx) responses.</span> This
            enables both machines and humans to know the high-level
            error class and fine-grained details.</p>
            <div class="note" id="issue-container-generatedID-7">
              <div role="heading" class="ednote-title marker" id=
              "h-ednote-7" aria-level="5">
                <span>Editor's note</span><span class=
                "issue-label">: WoT-specific error types</span>
              </div>
              <p class="">The Problem Details error
              <code>type</code> field is a URI reference which
              could used to map the occurred error to WoT-specific
              error class. There are few open issues raising the
              lack of WoT-specific error types: <a href=
              "https://github.com/w3c/wot-discovery/issues/44">wot-discovery#44</a>,
              <a href=
              "https://github.com/w3c/wot-thing-description/issues/303">
              wot-thing-description#303</a>, <a href=
              "https://github.com/w3c/wot-scripting-api/issues/200">
              wot-scripting-api#200</a>.<br>
              For now, <code>type</code> can be omitted which
              defaults to "about:blank", and <code>title</code>
              should be set to HTTP status text.</p>
            </div>
            <p>Below is a generic Thing Description for the
            Directory HTTP API with OAuth2 security. The Thing
            Description alone should not be considered as the full
            specification to implement or interact with a
            directory. Additional details for every interaction are
            described in human-readable form in the subsequent
            sections.</p>
            <aside class="example" id=
            "directory-thing-description">
              <div class="marker">
                <a class="self-link" href=
                "#directory-thing-description">Example
                <bdi>3</bdi></a><span class="example-title">: Thing
                Description of the Directory</span>
              </div>
              <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class=
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"@type"</span>: <span class=
"hljs-string">"DirectoryDescription"</span>,
    <span class="hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description Directory (TDD)"</span>,
    <span class="hljs-attr">"version"</span>: {
        <span class="hljs-attr">"instance"</span>: <span class=
"hljs-string">"1.0.0-alpha"</span>
    },
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"oauth2_code"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"oauth2"</span>,
            <span class="hljs-attr">"flow"</span>: <span class=
"hljs-string">"code"</span>,
            <span class=
"hljs-attr">"authorization"</span>: <span class=
"hljs-string">"https://auth.example.com/authorization"</span>,
            <span class="hljs-attr">"token"</span>: <span class=
"hljs-string">"https://auth.example.com/token"</span>,
            <span class="hljs-attr">"scopes"</span>: [
                <span class="hljs-string">"write"</span>,
                <span class="hljs-string">"read"</span>,
                <span class="hljs-string">"search"</span>
            ]
        },
        <span class="hljs-attr">"oauth2_client"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"oauth2"</span>,
            <span class="hljs-attr">"flow"</span>: <span class=
"hljs-string">"client"</span>,
            <span class="hljs-attr">"token"</span>: <span class=
"hljs-string">"https://auth.example.com/token"</span>,
            <span class="hljs-attr">"scopes"</span>: [
                <span class="hljs-string">"write"</span>,
                <span class="hljs-string">"read"</span>,
                <span class="hljs-string">"search"</span>
            ]
        },
        <span class="hljs-attr">"oauth2_device"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"oauth2"</span>,
            <span class="hljs-attr">"flow"</span>: <span class=
"hljs-string">"device"</span>,
            <span class=
"hljs-attr">"authorization"</span>: <span class=
"hljs-string">"https://auth.example.com/device_authorization"</span>,
            <span class="hljs-attr">"token"</span>: <span class=
"hljs-string">"https://auth.example.com/token"</span>,
            <span class="hljs-attr">"scopes"</span>: [
                <span class="hljs-string">"write"</span>,
                <span class="hljs-string">"read"</span>,
                <span class="hljs-string">"search"</span>
            ]
        },
        <span class="hljs-attr">"combo_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"combo"</span>,
            <span class="hljs-attr">"oneOf"</span>: [
                <span class="hljs-string">"oauth2_code"</span>,
                <span class="hljs-string">"oauth2_client"</span>,
                <span class="hljs-string">"oauth2_device"</span>
            ]
        }
    },
    <span class="hljs-attr">"security"</span>: <span class=
"hljs-string">"combo_sc"</span>,
    <span class="hljs-attr">"base"</span>: <span class=
"hljs-string">"https://tdd.example.com"</span>,
    <span class="hljs-attr">"actions"</span>: {
        <span class="hljs-attr">"createTD"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Create a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                    <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/td/{id}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"PUT"</span>,
                    <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">201</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"write"</span>
                },
                {
                    <span class=
"hljs-attr">"href"</span>: <span class="hljs-string">"/td"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"POST"</span>,
                    <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:headers"</span>: [
                            {
                                <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"System-generated UUID (version 4) URN"</span>,
                                <span class=
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Location"</span>,
                                <span class=
"hljs-attr">"htv:fieldValue"</span>: <span class=
"hljs-string">""</span>
                            }
                        ],
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">201</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"write"</span>
                }
            ]
        },
        <span class="hljs-attr">"updateTD"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Update a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                    <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/td/{id}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"PUT"</span>,
                    <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">204</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"write"</span>
                }
            ]
        },
        <span class="hljs-attr">"updatePartialTD"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Update parts of a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                    <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/td/{id}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"PATCH"</span>,
                    <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/merge-patch+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">204</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        },
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD with the given id not found"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">404</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"write"</span>
                }
            ]
        },
        <span class="hljs-attr">"deleteTD"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Delete a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                    <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/td/{id}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"DELETE"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">204</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD with the given id not found"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">404</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"write"</span>
                }
            ]
        }
    },
    <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"retrieveTD"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Retrieve a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                    <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/td/{id}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>,
                        <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD with the given id not found"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">404</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"read"</span>
                }
            ]
        },
        <span class="hljs-attr">"retrieveTDs"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Retrieve all Thing Descriptions"</span>,
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class="hljs-string">"/td"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>,
                        <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/ld+json"</span>,
                    },
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"readAll"</span>
                }
            ]
        },
        <span class="hljs-attr">"searchJSONPath"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath syntactic search"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"query"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"A valid JSONPath expression"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/jsonpath?query={query}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath expression not provided or contains syntax errors"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"search"</span>
                }
            ]
        },
        <span class="hljs-attr">"searchXPath"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"XPath syntactic search"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"query"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"A valid XPath expression"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/xpath?query={query}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath expression not provided or contains syntax errors"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"search"</span>
                }
            ]
        },
        <span class="hljs-attr">"searchSPARQL"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"SPARQL semantic search"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"query"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"A valid SPARQL 1.1. query"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/sparql?query={query}"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath expression not provided or contains syntax errors"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"search"</span>
                },
                {
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/sparql"</span>,
                    <span class=
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"POST"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
                        <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
                        <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
                    <span class=
"hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath expression not provided or contains syntax errors"</span>,
                            <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
                            <span class=
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ],
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"search"</span>
                }
            ]
        }
    },
    <span class="hljs-attr">"events"</span>: {
        <span class="hljs-attr">"registration"</span>: {
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD registration events"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"type"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Event type"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                    <span class="hljs-attr">"enum"</span>: [
                        <span class=
"hljs-string">"created_td"</span>,
                        <span class=
"hljs-string">"updated_td"</span>,
                        <span class=
"hljs-string">"deleted_td"</span>
                    ]
                },
                <span class="hljs-attr">"td_id"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Identifier of TD in directory"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                },
                <span class="hljs-attr">"include_changes"</span>: {
                    <span class=
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Include TD changes inside event data"</span>,
                    <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"boolean"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class=
"hljs-attr">"op"</span>: <span class=
"hljs-string">"subscribeevent"</span>,
                    <span class=
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/events{?type,td_id,include_changes}"</span>,
                    <span class=
"hljs-attr">"subprotocol"</span>: <span class=
"hljs-string">"sse"</span>,
                    <span class=
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"text/event-stream"</span>,
                    <span class="hljs-attr">"htv:headers"</span>: [
                        {
                            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"ID of the last event for reconnection"</span>,
                            <span class=
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Last-Event-ID"</span>,
                            <span class=
"hljs-attr">"htv:fieldValue"</span>: <span class=
"hljs-string">""</span>
                        }
                    ],
                    <span class="hljs-attr">"data"</span>: {
                        <span class="hljs-attr">"oneOf"</span>: [
                            {
                                <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"object"</span>,
                                <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema of event data"</span>,
                                <span class=
"hljs-attr">"properties"</span>: {
                                    <span class=
"hljs-attr">"td_id"</span>: {
                                        <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                                        <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>,
                                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Identifier of TD in directory"</span>
                                    }
                                }
                            },
                            {
                                <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"object"</span>,
                                <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema of create event data including the created TD"</span>,
                                <span class=
"hljs-attr">"properties"</span>: {
                                    <span class=
"hljs-attr">"td_id"</span>: {
                                        <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                                        <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>,
                                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Identifier of TD in directory"</span>
                                    },
                                    <span class=
"hljs-attr">"td"</span>: {
                                        <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"object"</span>,
                                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The created TD in a create event"</span>
                                    }
                                }
                            },
                            {
                                <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"object"</span>,
                                <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema of the update event data including the updates to TD"</span>,
                                <span class=
"hljs-attr">"properties"</span>: {
                                    <span class=
"hljs-attr">"td_id"</span>: {
                                        <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
                                        <span class=
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>,
                                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Identifier of TD in directory"</span>
                                    },
                                    <span class=
"hljs-attr">"td_updates"</span>: {
                                        <span class=
"hljs-attr">"type"</span>: <span class=
"hljs-string">"object"</span>,
                                        <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The partial TD composed of modified TD parts in an update event"</span>
                                    }
                                }
                            }
                        ]
                    },
                    <span class=
"hljs-attr">"scopes"</span>: <span class=
"hljs-string">"notifications"</span>
                }
            ]
        }
    }
}</code></pre>
              <div class="note" id="issue-container-generatedID-8">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-8" aria-level="5">
                  <span>Editor's note</span><span class=
                  "issue-label">: Normative JSON Block</span>
                </div>
                <p class="">Need to add a css class for normative
                code blocks, instead of using the
                <code>example</code> class.</p>
              </div>
              <div class="note" id="issue-container-generatedID-9">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-9" aria-level="5">
                  <span>Editor's note</span><span class=
                  "issue-label">: ID Type</span>
                </div>
                <p class="">The <code>id</code> variable need to
                have a defined type for semantic association with
                TD's <code>id</code> attribute.</p>
              </div>
              <div class="note" id=
              "issue-container-generatedID-10">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-10" aria-level="5">
                  <span>Editor's note</span><span class=
                  "issue-label">: Scopes</span>
                </div>
                <p class="">The scopes may need to be more concrete
                to able to allow updates but prevent creation.</p>
              </div>
            </aside>
            <div class="issue" id="issue-container-number-82">
              <div role="heading" class="issue-title marker" id=
              "h-issue-1" aria-level="5">
                <a href=
                "https://github.com/w3c/wot-discovery/issues/82"><span class="issue-number">
                Issue 82</span></a><span class="issue-label">:
                Creation of OpenAPI spec from Directory TD</span>
              </div>
              <p class="">Need to confirm if equivalent OpenAPI
              spec can be easily created out of the TD in <a href=
              "#directory-thing-description" class=
              "box-ref">Example <bdi>3</bdi></a>. If yes, a
              sentence may be added indicating this
              possibility.</p>
            </div>
            <section id="exploration-directory-api-registration"
            class="normative">
              <h5 id="x6-2-2-1-registration"><bdi class=
              "secno">6.2.2.1</bdi> Registration<a class=
              "self-link" aria-label="§" href=
              "#exploration-directory-api-registration"></a></h5>
              <p>The Registration API is a RESTful HTTP API in
              accordance with the recommendations defined in
              [<cite><a class="bibref" data-link-type="biblio"
              href="#bib-rfc7231" title=
              "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">RFC7231</a></cite>]
              and [<cite><a class="bibref" data-link-type="biblio"
              href="#bib-rest-iot" title=
              "RESTful Design for Internet of Things Systems">REST-IOT</a></cite>].
              <span class="rfc2119-assertion" id=
              "tdd-reg-default-representation">The default
              serialization format for all request and response
              bodies <em class="rfc2119">MUST</em> be JSON, with
              JSON-LD 1.1 [<cite><a class="bibref" data-link-type=
              "biblio" href="#bib-json-ld11" title=
              "JSON-LD 1.1">JSON-LD11</a></cite>] syntax to support
              extensions and semantic processing.</span>
              <span class="rfc2119-assertion" id=
              "tdd-reg-additional-representation">Directories
              <em class="rfc2119">MAY</em> accept additional
              representations based on request's indicated
              Content-Type or Content-Encoding, and provide
              additional representations through server-driven
              content negotiation.</span></p>
              <p><span class="rfc2119-assertion" id=
              "tdd-reg-operations">The Registration API <em class=
              "rfc2119">MUST</em> provide create, retrieve, update,
              delete, and listing (CRUDL) interfaces.</span> The
              operations are described below:</p>
              <section id=
              "exploration-directory-api-registration-creation"
              class="normative">
                <h6 id="x6-2-2-1-1-creation"><bdi class=
                "secno">6.2.2.1.1</bdi> Creation<a class=
                "self-link" aria-label="§" href=
                "#exploration-directory-api-registration-creation"></a></h6>
                <p><span class="rfc2119-assertion" id=
                "tdd-reg-create-body">The API <em class=
                "rfc2119">MUST</em> allow registration of a TD
                object passed as request body.</span> <span class=
                "rfc2119-assertion" id=
                "tdd-reg-create-contenttype">The request <em class=
                "rfc2119">SHOULD</em> contain
                <code>application/td+json</code> Content-Type
                header for JSON serialization of TD.</span> The TD
                object must be validated in accordance with
                <a href="#validation" class=
                "sec-ref">§&nbsp;<bdi class="secno">6.2.2.1.6</bdi>
                Validation</a>.</p>
                <p><span class="rfc2119-assertion" id=
                "tdd-reg-types">A TD which is identified with an
                <code>id</code> attribute <em class=
                "rfc2119">MUST</em> be handled differently with one
                that has no identifier (<a href=
                "#dfn-wot-anonymous-thing-description" class=
                "internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-wot-anonymous-thing-description-1">Anonymous
                TD</a>).</span> The create operations are specified
                as <code>createTD</code> action in <a href=
                "#directory-thing-description" class=
                "box-ref">Example <bdi>3</bdi></a> and elaborated
                below:</p>
                <ul>
                  <li>
                    <span class="rfc2119-assertion" id=
                    "tdd-reg-create-known-td">A TD <em class=
                    "rfc2119">MUST</em> be submitted to the
                    directory using an HTTP <code>PUT</code>
                    request at a target location (HTTP path)
                    containing the unique TD
                    <code>id</code>.</span> <span class=
                    "rfc2119-assertion" id=
                    "tdd-reg-create-known-td-resp">Upon successful
                    processing, the server <em class=
                    "rfc2119">MUST</em> respond with 201 (Created)
                    status.</span>
                    <p>Note: If the target location corresponds to
                    an existing TD, the request shall instead
                    proceed as an Update operation and respond the
                    appropriate status code (see Update
                    section).</p>
                  </li>
                  <li><span class="rfc2119-assertion" id=
                  "tdd-reg-create-anonymous-td">An <a href=
                  "#dfn-wot-anonymous-thing-description" class=
                  "internalDFN" data-link-type="dfn" id=
                  "ref-for-dfn-wot-anonymous-thing-description-2">Anonymous
                  TD</a> <em class="rfc2119">MUST</em> be submitted
                  to the directory using an HTTP <code>POST</code>
                  request.</span> <span class="rfc2119-assertion"
                  id="tdd-reg-create-anonymous-td-resp">Upon
                  successful processing, the server <em class=
                  "rfc2119">MUST</em> respond with 201 (Created)
                  status and a Location header containing a
                  system-generated identifier for the TD.</span>
                  <span class="rfc2119-assertion" id=
                  "tdd-reg-create-anonymous-td-generated-id"></span>
                  The identifier <em class="rfc2119">SHOULD</em> be
                  a Version 4 UUID URN [<cite><a class="bibref"
                  data-link-type="biblio" href="#bib-rfc4122"
                  title="A Universally Unique IDentifier (UUID) URN Namespace">RFC4122</a></cite>].</li>
                </ul>
                <p>Error responses:</p>
                <ul>
                  <li>400 (Bad Request): Invalid serialization or
                  TD. This is accompanied by an appropriate
                  response message.</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                </ul>
                <div class="issue closed" id=
                "issue-container-number-18">
                  <div role="heading" class="issue-title marker"
                  id="h-issue-2" aria-level="7">
                    <a href=
                    "https://github.com/w3c/wot-discovery/issues/18">
                    <span class="issue-number">Issue
                    18</span></a><span class="issue-label">:
                    Consider TTL Use cases</span>
                  </div>
                  <div class="">
                    In certain scenarios (e.g. automatic removal of
                    obsolete or accidental registrations), the
                    registration may benefit from an expiration
                    time. The expiration time may be set explicitly
                    or relative to the registration time as a
                    time-to-live (TTL) value.
                  </div>
                </div>
                <div class="issue" id="issue-container-number-48">
                  <div role="heading" class="issue-title marker"
                  id="h-issue-3" aria-level="7">
                    <a href=
                    "https://github.com/w3c/wot-discovery/issues/48">
                    <span class="issue-number">Issue
                    48</span></a><span class="issue-label">: How to
                    avoid duplicates in a directory</span>
                  </div>
                  <p>Registration of TDs using non-idempotent HTTP
                  POST method enables creation of anonymous TDs
                  (TDs without <code>id</code> attribute). The
                  producer can distinguish between the created TDs
                  using the unique-system generated IDs given in
                  the response Location header.</p>
                  <p>A side-effect of this is that clients will be
                  able to register duplicate TDs accidentally or on
                  purpose.</p>
                  <p>Need to clarify:</p>
                  <ul>
                    <li>What are the use cases where a duplicate TD
                    is desired?</li>
                    <li>How can we mitigate accidental duplicates
                    (deduplication)?</li>
                  </ul>
                </div>
              </section>
              <section id=
              "exploration-directory-api-registration-retrieval"
              class="normative">
                <h6 id="x6-2-2-1-2-retrieval"><bdi class=
                "secno">6.2.2.1.2</bdi> Retrieval<a class=
                "self-link" aria-label="§" href=
                "#exploration-directory-api-registration-retrieval"></a></h6>
                <p><span class="rfc2119-assertion" id=
                "tdd-reg-retrieve">A TD <em class=
                "rfc2119">MUST</em> be retrieved from the directory
                using an HTTP <code>GET</code> request, including
                the identifier of the TD as part of the
                path.</span> <span class="rfc2119-assertion" id=
                "tdd-reg-retrieve-resp">A successful response
                <em class="rfc2119">MUST</em> have 200 (OK) status,
                contain <code>application/td+json</code>
                Content-Type header, and the requested TD in
                body.</span> The retrieve operation is specified as
                <code>retrieveTD</code> property in <a href=
                "#directory-thing-description" class=
                "box-ref">Example <bdi>3</bdi></a>.</p>
                <p>Error responses:</p>
                <ul>
                  <li>404 (Not Found): TD with the given
                  <code>id</code> not found.</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                </ul>
                <div class="note" id=
                "issue-container-generatedID-11">
                  <div role="heading" class="ednote-title marker"
                  id="h-ednote-11" aria-level="7">
                    <span>Editor's note</span><span class=
                    "issue-label">: Registration Info query
                    argument</span>
                  </div>
                  <p class="">Need to specify and describe the
                  query argument to toggle enrichment of TD with
                  registration info.</p>
                </div>The following is an example queried TD,
                enriched with the registration info per request:
                <aside class="example" id=
                "example-td-registration-info">
                  <div class="marker">
                    <a class="self-link" href=
                    "#example-td-registration-info">Example
                    <bdi>4</bdi></a><span class="example-title">:
                    Example TD with Registration Info</span>
                  </div>
                  <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class=
"hljs-string">"https://www.w3.org/2019/wot/td/v1"</span>,
        <span class=
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"id"</span>: <span class=
"hljs-string">"urn:example:simple-td"</span>,
    <span class="hljs-attr">"security"</span>: <span class=
"hljs-string">"basic_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"basic_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"basic"</span>
        }
    },
    <span class="hljs-attr">"tdd:registration"</span>: {
        <span class="hljs-attr">"tdd:created"</span>: <span class=
"hljs-string">"2021-01-19T17:02:00Z"</span>,
        <span class="hljs-attr">"tdd:modified"</span>: <span class=
"hljs-string">"2021-01-19T17:02:00Z"</span>
    },
    <span class="hljs-attr">"title"</span>: <span class=
"hljs-string">"Simple TD"</span>
}</code></pre>
                </aside>
              </section>
              <section id=
              "exploration-directory-api-registration-update"
              class="normative">
                <h6 id="x6-2-2-1-3-update"><bdi class=
                "secno">6.2.2.1.3</bdi> Update<a class="self-link"
                aria-label="§" href=
                "#exploration-directory-api-registration-update"></a></h6>
                <p><span class="rfc2119-assertion" id=
                "tdd-reg-update-types">The API <em class=
                "rfc2119">MUST</em> allow modifications to an
                existing TD as full replacement or partial
                updates.</span> The update operations are described
                below:</p>
                <ul>
                  <li>
                    <span class="rfc2119-assertion" id=
                    "tdd-reg-update">A modified TD <em class=
                    "rfc2119">MUST</em> replace an existing one
                    when submitted using an HTTP <code>PUT</code>
                    request to the location corresponding to the
                    existing TD.</span> <span class=
                    "rfc2119-assertion" id=
                    "tdd-reg-update-contenttype">The request
                    <em class="rfc2119">SHOULD</em> contain
                    <code>application/td+json</code> Content-Type
                    header for JSON serialization of TD.</span> The
                    TD object must be validated in accordance with
                    <a href="#validation" class=
                    "sec-ref">§&nbsp;<bdi class=
                    "secno">6.2.2.1.6</bdi> Validation</a>.
                    <span class="rfc2119-assertion" id=
                    "tdd-reg-update-resp">Upon success, the server
                    <em class="rfc2119">MUST</em> respond with 204
                    (No Content) status.</span> This operation is
                    specified as <code>updateTD</code> property in
                    <a href="#directory-thing-description" class=
                    "box-ref">Example <bdi>3</bdi></a>.
                    <p>Note: If the target location does not
                    correspond to an existing TD, the request shall
                    instead proceed as a Create operation and
                    respond the appropriate status code (see Create
                    section). In other words, an HTTP
                    <code>PUT</code> request acts as a create or
                    update operation.</p>
                  </li>
                  <li>
                    <span class="rfc2119-assertion" id=
                    "tdd-reg-update-partial">An existing TD
                    <em class="rfc2119">MUST</em> be partially
                    modified when the modified parts are submitted
                    using an HTTP <code>PATCH</code> request to the
                    location corresponding to the existing
                    TD.</span> <span class="rfc2119-assertion" id=
                    "tdd-reg-update-partial-mergepatch">The partial
                    update <em class="rfc2119">MUST</em> be
                    processed using the JSON merge patch format
                    format described in [<cite><a class="bibref"
                    data-link-type="biblio" href="#bib-rfc7396"
                    title=
                    "JSON Merge Patch">RFC7396</a></cite>].</span>
                    <span class="rfc2119-assertion" id=
                    "tdd-reg-update-partial-contenttype">The
                    request <em class="rfc2119">MUST</em> contain
                    <code>application/merge-patch+json</code>
                    Content-Type header for JSON serialization of
                    the merge patch document.</span> <span class=
                    "rfc2119-assertion" id=
                    "tdd-reg-update-partial-partialtd">The input
                    <em class="rfc2119">MUST</em> be in <a href=
                    "#dfn-wot-partial-thing-description" class=
                    "internalDFN" data-link-type="dfn" id=
                    "ref-for-dfn-wot-partial-thing-description-1">Partial
                    TD</a> form and conform to the original TD
                    structure.</span> If the input contains members
                    that appear in the original TD, their values
                    are replaced. If a member do not appear in the
                    original TD, that member is added. If the
                    member is set to <code>null</code> but appear
                    in the original TD, that member is removed.
                    Members with object values are processed
                    recursively. After applying the modifications,
                    the TD object must be validated in accordance
                    with <a href="#validation" class=
                    "sec-ref">§&nbsp;<bdi class=
                    "secno">6.2.2.1.6</bdi> Validation</a>.
                    <span class="rfc2119-assertion" id=
                    "tdd-reg-update-partial-resp">Upon success, the
                    server <em class="rfc2119">MUST</em> respond
                    with a 204 (No Content) status.</span> This
                    operation is specified as
                    <code>updatePartialTD</code> property in
                    <a href="#directory-thing-description" class=
                    "box-ref">Example <bdi>3</bdi></a>.
                  </li>
                </ul>
                <p>Error responses:</p>
                <ul>
                  <li>400 (Bad Request): Invalid serialization or
                  TD. This is accompanied by an appropriate
                  response message.</li>
                  <li>404 (Not Found): TD with the given
                  <code>id</code> not found (for <code>PATCH</code>
                  only).</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                </ul>
              </section>
              <section id=
              "exploration-directory-api-registration-deletion"
              class="normative">
                <h6 id="x6-2-2-1-4-deletion"><bdi class=
                "secno">6.2.2.1.4</bdi> Deletion<a class=
                "self-link" aria-label="§" href=
                "#exploration-directory-api-registration-deletion"></a></h6>
                <p><span class="rfc2119-assertion" id=
                "tdd-reg-delete">A TD <em class="rfc2119">MUST</em>
                be removed from the directory when an HTTP
                <code>DELETE</code> request is submitted to the
                location corresponding to the existing TD.</span>
                <span class="rfc2119-assertion" id=
                "tdd-reg-delete-resp">A successful response
                <em class="rfc2119">MUST</em> have 204 (No Content)
                status.</span> The retrieve operation is specified
                as <code>deleteTD</code> property in <a href=
                "#directory-thing-description" class=
                "box-ref">Example <bdi>3</bdi></a>.</p>
                <p>Error responses:</p>
                <ul>
                  <li>404 (Not Found): TD with the given
                  <code>id</code> not found.</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                </ul>
              </section>
              <section id=
              "exploration-directory-api-registration-listing"
              class="normative">
                <h6 id="x6-2-2-1-5-listing"><bdi class=
                "secno">6.2.2.1.5</bdi> Listing<a class="self-link"
                aria-label="§" href=
                "#exploration-directory-api-registration-listing"></a></h6>
                <p>The listing endpoint provides a way to query the
                collection of TD objects from the directory. The
                Search API may be used to retrieve <a href=
                "#dfn-wot-partial-thing-description" class=
                "internalDFN" data-link-type="dfn" id=
                "ref-for-dfn-wot-partial-thing-description-2">Partial
                TD</a>s or TD fragments; see <a href=
                "#exploration-directory-api-search" class=
                "sec-ref">§&nbsp;<bdi class="secno">6.2.2.4</bdi>
                Search</a>.</p>
                <p><span class="rfc2119-assertion" id=
                "tdd-reg-list-method">The list of TDs <em class=
                "rfc2119">MUST</em> be retrieved from the directory
                using an HTTP <code>GET</code> request.</span>
                <span class="rfc2119-assertion" id=
                "tdd-reg-list-resp">A successful response
                <em class="rfc2119">MUST</em> have 200 (OK) status,
                contain <code>application/ld+json</code>
                Content-Type header, and an array of TDs in the
                body.</span></p>
                <p>Serializing and returning the full list of TDs
                may be burdensome to servers. As such, servers
                should serialize incrementally and utilize
                protocol-specific mechanisms to respond in chunks.
                <span class="rfc2119-assertion" id=
                "tdd-reg-list-http11">HTTP/1.1 servers <em class=
                "rfc2119">SHOULD</em> perform chunked <a href=
                "https://tools.ietf.org/html/rfc7230#section-3.3.1">
                Transfer-Encoding</a> [<cite><a class="bibref"
                data-link-type="biblio" href="#bib-rfc7230" title=
                "Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">RFC7230</a></cite>]
                to respond the data incrementally.</span> Most
                HTTP/1.1 clients automatically process the data
                received with chunked transfer encoding.
                Memory-constrained applications which require the
                full list should consider processing the received
                data incrementally. Chunked transfer encoding is
                not supported in HTTP/2. <span class=
                "rfc2119-assertion" id="tdd-reg-list-http2">HTTP/2
                servers <em class="rfc2119">SHOULD</em> respond the
                data incrementally using <a href=
                "https://tools.ietf.org/html/rfc7540#section-4">HTTP
                Frames</a> [<cite><a class="bibref" data-link-type=
                "biblio" href="#bib-rfc7540" title=
                "Hypertext Transfer Protocol Version 2 (HTTP/2)">RFC7540</a></cite>].</span></p>
                <p>The paginated list operation is specified as
                <code>retrieveTDs</code> property in <a href=
                "#directory-thing-description" class=
                "box-ref">Example <bdi>3</bdi></a>.</p>
                <p>Error responses:</p>
                <ul>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                </ul>
              </section>
              <section id="validation" class="normative">
                <h6 id="x6-2-2-1-6-validation"><bdi class=
                "secno">6.2.2.1.6</bdi> Validation<a class=
                "self-link" aria-label="§" href=
                "#validation"></a></h6>
                <p><span class="rfc2119-assertion" id=
                "td-validation-syntactic">The syntactic validation
                of TD objects before storage is <em class=
                "rfc2119">RECOMMENDED</em> to prevent common
                erroneous submissions.</span> <span class=
                "rfc2119-assertion" id=
                "td-validation-jsonschema">The server <em class=
                "rfc2119">MAY</em> use <a href=
                "https://www.w3.org/TR/wot-thing-description/#json-schema-for-validation">
                Thing Description JSON Schema</a> to validate
                standard TD vocabulary, or a more comprehensive
                JSON Schema to also validate extensions.</span></p>
                <p><span class="rfc2119-assertion" id=
                "td-validation-result">If the server fails to
                validate the TD object, it <em class=
                "rfc2119">MUST</em> inform the client with
                necessary details to identify and resolve the
                errors.</span> <span class="rfc2119-assertion" id=
                "td-validation-response">The validation error
                <em class="rfc2119">MUST</em> be described as
                Problem Details [<cite><a class="bibref"
                data-link-type="biblio" href="#bib-rfc7807" title=
                "Problem Details for HTTP APIs">RFC7807</a></cite>]
                with an extension field called
                <code>validationErrors</code>, set to an array of
                objects with <code>field</code> and
                <code>description</code> fields.</span> This is
                necessary to represent the error in a
                machine-readable way.</p><a href=
                "#example-validation-error" class="box-ref">Example
                <bdi>5</bdi></a> is an example error response with
                two validation errors.
                <aside class="example" id=
                "example-validation-error">
                  <div class="marker">
                    <a class="self-link" href=
                    "#example-validation-error">Example
                    <bdi>5</bdi></a><span class="example-title">:
                    Example validation error response</span>
                  </div>
                  <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"title"</span>: <span class=
"hljs-string">"Bad Request"</span>,
    <span class="hljs-attr">"status"</span>: <span class=
"hljs-number">400</span>,
    <span class="hljs-attr">"detail"</span>: <span class=
"hljs-string">"The input did not pass the JSON Schema validation"</span>,
    <span class="hljs-attr">"instance"</span>: <span class=
"hljs-string">"/errors/30585584-cce2-4d04-8079-67b33ffdafbc"</span>,
    <span class="hljs-attr">"validationErrors"</span>: [
        {
            <span class="hljs-attr">"field"</span>: <span class=
"hljs-string">"(root)"</span>,
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"security is required"</span>
        },
        {
            <span class="hljs-attr">"field"</span>: <span class=
"hljs-string">"properties.status.forms.0.href"</span>,
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid type. Expected: string, given: integer"</span>
        }
    ]
}</code></pre>
                  <div class="note" id=
                  "issue-container-generatedID-12">
                    <div role="heading" class="ednote-title marker"
                    id="h-ednote-12" aria-level="7">
                      <span>Editor's note</span><span class=
                      "issue-label">: Validation error type</span>
                    </div>
                    <p class="">This example skips the
                    <code>type</code> field due to the current lack
                    of specific error types. See notes in <a href=
                    "#exploration-directory-api" class=
                    "sec-ref">§&nbsp;<bdi class="secno">6.2.2</bdi>
                    Directory Service API</a>.</p>
                  </div>
                </aside>
                <div class="issue" id="issue-container-number-99">
                  <div role="heading" class="issue-title marker"
                  id="h-issue-4" aria-level="7">
                    <a href=
                    "https://github.com/w3c/wot-discovery/issues/99">
                    <span class="issue-number">Issue
                    99</span></a><span class="issue-label">: Define
                    requirements and add section for
                    validation</span>
                  </div>
                  <p>How much validation does a directory need to
                  do?</p>
                  <ol>
                    <li>If it only supports syntactic queries, is
                    JSONSchema validation sufficient? Do we also
                    use SHACL?</li>
                    <li>If we support SPARQL, do we need to do more
                    to make sure the ontologies used are
                    correct?</li>
                    <li>Is there a subset of TD assertions we
                    should check?</li>
                  </ol>
                </div>
              </section>
            </section>
            <section id="exploration-directory-api-management"
            class="normative">
              <h5 id="x6-2-2-2-management"><bdi class=
              "secno">6.2.2.2</bdi> Management<a class="self-link"
              aria-label="§" href=
              "#exploration-directory-api-management"></a></h5>
              <div class="note" id=
              "issue-container-generatedID-13">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-13" aria-level="6">
                  <span>Editor's note</span><span class=
                  "issue-label">: Management API</span>
                </div>
                <p class="">To do: Other administrative functions
                not having to do with CRUD of individual records,
                for example, security configuration. Also,
                administrator roles may expand the capabilities of
                administrators for management of records (for
                instance, the ability to delete a record they did
                not create).</p>
              </div>
            </section>
            <section id="exploration-directory-api-notification"
            class="normative">
              <h5 id="x6-2-2-3-notification"><bdi class=
              "secno">6.2.2.3</bdi> Notification<a class=
              "self-link" aria-label="§" href=
              "#exploration-directory-api-notification"></a></h5>
              <div class="note" id=
              "issue-container-generatedID-14">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-14" aria-level="6">
                  <span>Editor's note</span><span class=
                  "issue-label">: Notification API Changes</span>
                </div>
                <p class="">The query and payload specification are
                subject to change for simplification and
                consistency with other API features (e.g. Anonymous
                TD, partial TD format [<cite><a class="bibref"
                data-link-type="biblio" href="#bib-rfc7396" title=
                "JSON Merge Patch">RFC7396</a></cite>]).</p>
              </div>
              <p>The Notification API is to notify clients about
              the changes to Thing Descriptions maintained within
              the directory. <span class="rfc2119-assertion" id=
              "tdd-notification-sse">The Notification API
              <em class="rfc2119">MUST</em> follow the Server-Sent
              Events [<cite><a class="bibref" data-link-type=
              "biblio" href="#bib-eventsource" title=
              "Server-Sent Events">EVENTSOURCE</a></cite>]
              specifications to serve events to clients.</span> In
              particular, the server responds to successful
              requests with 200 (OK) status and
              <code>text/event-stream</code> Content Type.
              Re-connecting clients may continue from the last
              event by providing the last event ID as
              <code>Last-Event-ID</code> header value. This API is
              specified as <code>registration</code> event in
              <a href="#directory-thing-description" class=
              "box-ref">Example <bdi>3</bdi></a>.</p>
              <dl>
                <dt>Event Types</dt>
                <dd><span class="rfc2119-assertion" id=
                "tdd-notification-event-types">The server
                <em class="rfc2119">MUST</em> produce events for
                creation, update, and deletion of Thing
                Descriptions represented by
                <code>created_td</code>, <code>updated_td</code>,
                <code>deleted_td</code> keywords
                respectively.</span></dd>
                <dt>Event Filtering</dt>
                <dd>
                  The API supports server-side filtering of events
                  to reduce resource consumption by delivering only
                  the events required by clients. The filtering is
                  based on query parameters passed to the server at
                  connection time. The filtering behavior is
                  described below:
                  <ul>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-filter-type">The server
                    <em class="rfc2119">MUST</em> support event
                    filtering based on the event types passed as
                    one or more <code>type</code> query
                    parameters.</span> For example, in response to
                    query
                    <code>?type=created_td&amp;type=deleted_td</code>,
                    the server must only deliver events of types
                    <code>created_td</code> and
                    <code>deleted_td</code>. At the absence of any
                    <code>type</code> query parameter, the server
                    must deliver all types of events.</li>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-filter-tdid">The server
                    <em class="rfc2119">MUST</em> support event
                    filtering based on the Thing Description
                    identifier passed as one or more
                    <code>td_id</code> query parameters.</span> For
                    example, the query
                    <code>?type=updated_td&amp;td_id=urn:example:1234</code>
                    must result in <code>updated_td</code> events
                    for the TD identified with
                    <code>urn:example:1234</code>.</li>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-filter-search">The server
                    <em class="rfc2119">MAY</em> support event
                    filtering based on the search expressions
                    passed as one of <code>jsonpath</code>,
                    <code>xpath</code>, or <code>sparql</code>
                    query parameters.</span> <span class=
                    "rfc2119-assertion" id=
                    "tdd-notification-filter-search-unsupported">If
                    the server does not support a given search
                    query parameter, it <em class=
                    "rfc2119">MUST</em> reject the request with 501
                    (Not Implemented) status.</span></li>
                  </ul>
                </dd>
                <dt>Event Data</dt>
                <dd>
                  <span class="rfc2119-assertion" id=
                  "tdd-notification-data">The event data <em class=
                  "rfc2119">MUST</em> contain the JSON
                  serialization of the event object.</span> The
                  event data object is defined by the following
                  rules:
                  <ul>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-data-tdid">The event data
                    object <em class="rfc2119">MUST</em> at least
                    include the identifier of the TD created,
                    updated, or deleted at that event as value of
                    <code>td_id</code> field.</span></li>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-data-createdtd">When
                    <code>include_changes</code> query parameter is
                    set to <code>true</code>, the create event data
                    object <em class="rfc2119">MAY</em> include the
                    created TD as the value of
                    <code>created_td</code> field.</span></li>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-data-tdupdates">When
                    <code>include_changes</code> query parameter is
                    set to <code>true</code>, the update event data
                    object <em class="rfc2119">MAY</em> include the
                    updated parts of the TD in <a href=
                    "#dfn-wot-partial-thing-description" class=
                    "internalDFN" data-link-type="dfn" id=
                    "ref-for-dfn-wot-partial-thing-description-3">Partial
                    TD</a> form as the value of
                    <code>td_updates</code> field.</span></li>
                    <li><span class="rfc2119-assertion" id=
                    "tdd-notification-data-change-unsupported">When
                    a server which does not support the inclusion
                    of changes inside event data object is
                    requested with a <code>include_changes</code>
                    query parameter, it <em class=
                    "rfc2119">MUST</em> reject the request with 501
                    (Not Implemented) status.</span></li>
                  </ul>
                </dd>
              </dl>
              <div class="note" id=
              "issue-container-generatedID-15">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-15" aria-level="6">
                  <span>Editor's note</span><span class=
                  "issue-label">: SSE Authorization Header</span>
                </div>
                <p class="">Some early SSE implementations
                (including HTML5 EventSource) do not allow setting
                custom headers in the initial HTTP request.
                Authorization header is required in few OAuth2
                flows and passing it as a query parameter is
                <a href=
                "https://tools.ietf.org/html/rfc6750#section-2.3">not
                advised</a>. There are polyfills for browsers and
                modern libraries which allow setting Authorization
                header.</p>
              </div>
            </section>
            <section id="exploration-directory-api-search" class=
            "normative">
              <h5 id="x6-2-2-4-search"><bdi class=
              "secno">6.2.2.4</bdi> Search<a class="self-link"
              aria-label="§" href=
              "#exploration-directory-api-search"></a></h5>
              <div class="note" id=
              "issue-container-generatedID-16">
                <div role="heading" class="ednote-title marker" id=
                "h-ednote-16" aria-level="6">
                  <span>Editor's note</span><span class=
                  "issue-label">: Search API Overview</span>
                </div>
                <p class="">Sub-API to search a directory, e.g.
                issue a query. There are different forms and levels
                of query possible, for example, syntactic
                (JSONPath, XPath) vs. semantic (SPARQL), and the
                more advanced query types may not be supported by
                all directories. So this API will have further
                subsections, some of which will be optional. Search
                also includes a sub-API for managing listing the
                contents (eg returned by a query) including
                handling pagination, etc. Note that one special
                form of query will be able to return everything.
                Results may be subject to the requestor's
                authorization.<br>
                To discuss further: Federated queries to other
                TDDs, Spatial and network-limited queries,
                Links</p>
              </div>The Directory has three search APIs: syntactic
              search with JSONPath [<cite><a class="bibref"
              data-link-type="biblio" href="#bib-jsonpath" title=
              "JavaScript Object Notation (JSON) Path">JSONPATH</a></cite>]
              or XPath [<cite><a class="bibref" data-link-type=
              "biblio" href="#bib-xpath-31" title=
              "XML Path Language (XPath) 3.1">xpath-31</a></cite>],
              and semantic search with SPARQL [<cite><a class=
              "bibref" data-link-type="biblio" href=
              "#bib-sparql11-overview" title=
              "SPARQL 1.1 Overview">sparql11-overview</a></cite>].
              <span class="rfc2119-assertion" id=
              "tdd-search-apis-jsonPath">The Directory <em class=
              "rfc2119">MUST</em> implement the syntactic search
              with JSONPath.</span> <span class="rfc2119-assertion"
              id="tdd-search-apis-xPath">The Directory <em class=
              "rfc2119">SHOULD</em> implement the syntactic search
              with XPath.</span> <span class="rfc2119-assertion"
              id="tdd-search-apis-sparql">The Directory <em class=
              "rfc2119">MAY</em> implement semantic search with
              SPARQL.</span>
              <section id="jsonpath-semantic" class="normative">
                <h6 id="x6-2-2-4-1-syntactic-search-jsonpath">
                <bdi class="secno">6.2.2.4.1</bdi> Syntactic
                search: JSONPath<a class="self-link" aria-label="§"
                href="#jsonpath-semantic"></a></h6><span class=
                "rfc2119-assertion" id=
                "tdd-search-jsonpath-method">The API <em class=
                "rfc2119">MUST</em> allow searching TDs using an
                HTTP <code>GET</code> request.</span> <span class=
                "rfc2119-assertion" id=
                "tdd-search-jsonpath-parameter">The request
                <em class="rfc2119">MUST</em> contain a valid
                JSONPath [<cite><a class="bibref" data-link-type=
                "biblio" href="#bib-jsonpath" title=
                "JavaScript Object Notation (JSON) Path">JSONPATH</a></cite>]
                as searching parameter.</span> <span class=
                "rfc2119-assertion" id=
                "tdd-search-jsonpath-response">A successful
                response <em class="rfc2119">MUST</em> have 200
                (OK) status, contain <code>application/json</code>
                Content-Type header, and in the body a set of
                complete TDs or a set of TD fragments.</span> The
                syntactic search with JSONPath is specified as
                <code>searchJSONPath</code> property in <a href=
                "#directory-thing-description" class=
                "box-ref">Example <bdi>3</bdi></a>.
                <p>List of errors:</p>
                <ul>
                  <li>400 (Bad Request): JSONPath expression not
                  provided or contains syntax errors.</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                </ul>
                <div class="issue" id="issue-container-number-56">
                  <div role="heading" class="issue-title marker"
                  id="h-issue-5" aria-level="7">
                    <a href=
                    "https://github.com/w3c/wot-discovery/issues/56">
                    <span class="issue-number">Issue
                    56</span></a><span class="issue-label"
                    aria-label="This issue is labelled as T2TRG.">:
                    Reach out to JSONPath community <a class=
                    "respec-gh-label" href=
                    "https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22T2TRG%22"
                    style=
                    "background-color: rgb(198, 129, 55); color: rgb(0, 0, 0);">
                    T2TRG</a></span>
                  </div>
                  <div class="">
                    The standardization of JSONPath expressions is
                    in progress by an independent working group.
                  </div>
                </div>
              </section>
              <section id="xpath-semantic" class="normative">
                <h6 id="x6-2-2-4-2-syntactic-search-xpath">
                <bdi class="secno">6.2.2.4.2</bdi> Syntactic
                search: XPath<a class="self-link" aria-label="§"
                href="#xpath-semantic"></a></h6>The support for
                XPath Search API is recommended. <span class=
                "rfc2119-assertion" id="tdd-search-xpath-method">If
                implemented, the XPath query API <em class=
                "rfc2119">MUST</em> allow searching TDs using an
                HTTP <code>GET</code> request.</span> <span class=
                "rfc2119-assertion" id=
                "tdd-search-xpath-parameter">The request <em class=
                "rfc2119">MUST</em> contain a valid XPath
                [<cite><a class="bibref" data-link-type="biblio"
                href="#bib-xpath-31" title=
                "XML Path Language (XPath) 3.1">xpath-31</a></cite>]
                as search parameter.</span> <span class=
                "rfc2119-assertion" id=
                "tdd-search-xpath-response">A successful response
                <em class="rfc2119">MUST</em> have 200 (OK) status,
                contain <code>application/json</code> Content-Type
                header, and in the body a set of complete TDs or a
                set of TD fragments.</span> The syntactic search
                with XPath is specified as <code>searchXPath</code>
                property in <a href="#directory-thing-description"
                class="box-ref">Example <bdi>3</bdi></a>.
                <p>List of errors:</p>
                <ul>
                  <li>400 (Bad Request): XPath expression not
                  provided or contains syntax errors.</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                  <li>501 (Not Implemented): XPath API not
                  supported.</li>
                </ul>
              </section>
              <section id="search-semantic" class="normative">
                <h6 id="x6-2-2-4-3-semantic-search-sparql">
                <bdi class="secno">6.2.2.4.3</bdi> Semantic search:
                SPARQL<a class="self-link" aria-label="§" href=
                "#search-semantic"></a></h6>The support for SPARQL
                Search API is optional. <span class=
                "rfc2119-assertion" id=
                "tdd-search-semantic-protocol">If implemented, the
                SPARQL search API <em class="rfc2119">MUST</em>
                allow searching TDs using the SPARQL protocol
                [<cite><a class="bibref" data-link-type="biblio"
                href="#bib-sparql11-overview" title=
                "SPARQL 1.1 Overview">sparql11-overview</a></cite>].</span>
                <span class="rfc2119-assertion" id=
                "tdd-search-semantic-method-get">The SPARQL API
                <em class="rfc2119">MUST</em> accept queries using
                HTTP <code>GET</code> requests.</span> <span class=
                "rfc2119-assertion" id=
                "tdd-search-semantic-method-post">The support for
                SPARQL search using HTTP <code>POST</code> method
                is <em class="rfc2119">OPTIONAL</em>.</span>
                <code>UPDATE</code> queries are out of the scope
                for the API. <span class="rfc2119-assertion" id=
                "tdd-search-semantic-parameter">A successful
                response <em class="rfc2119">MUST</em> have 200
                (OK) status, and depending on the type of query
                contain by default as Content-Type header
                <code>application/ld+json</code> for
                <code>CONSTRUCT</code> and <code>DESCRIBE</code>
                queries or <code>application/json</code> for
                <code>SELECT</code> or <code>ASK</code>. The
                response body <em class="rfc2119">MAY</em> contain
                TD fragments or a set of TDs depending on the
                query.</span> The semantic search with SPARQL is
                specified as <code>searchSPARQL</code> property in
                <a href="#directory-thing-description" class=
                "box-ref">Example <bdi>3</bdi></a>.
                <p>List of errors:</p>
                <ul>
                  <li>400 (Bad Request): SPARQL query not provided
                  or contains syntax errors.</li>
                  <li>401 (Unauthorized): No authentication.</li>
                  <li>403 (Forbidden): Insufficient rights to the
                  resource.</li>
                  <li>501 (Not Implemented): SPARQL API not
                  supported.</li>
                </ul><span class="rfc2119-assertion" id=
                "tdd-distributed-search-semantic">A WoT Thing
                Description Directory <em class="rfc2119">MAY</em>
                implement federation in its SPARQL query
                API.</span> <span class="rfc2119-assertion" id=
                "tdd-distributed-search-semantic-imp">If
                implemented, the SPARQL API <em class=
                "rfc2119">MUST</em> implement the SPARQL 1.1
                Federated Query standard [<cite><a class="bibref"
                data-link-type="biblio" href=
                "#bib-sparql11-overview" title=
                "SPARQL 1.1 Overview">sparql11-overview</a></cite>].</span>
              </section>
            </section>
          </section>
          <section id="exploration-directory-security" class=
          "normative">
            <h4 id="x6-2-3-security-and-privacy"><bdi class=
            "secno">6.2.3</bdi> Security and Privacy<a class=
            "self-link" aria-label="§" href=
            "#exploration-directory-security"></a></h4>
            <div class="note" id="issue-container-generatedID-17">
              <div role="heading" class="ednote-title marker" id=
              "h-ednote-17" aria-level="5">
                <span>Editor's note</span><span class=
                "issue-label">: Security Considerations
                Overview</span>
              </div>
              <p class="">Minimum security and privacy requirements
              for confidentiality, authentication, access control,
              etc.</p>
            </div>
          </section>
        </section>
      </dd>
    </dl>
  </section>
  <section id="security-considerations" class="informative">
    <h2 id="x7-security-and-privacy-considerations"><bdi class=
    "secno">7.</bdi> Security and Privacy Considerations<a class=
    "self-link" aria-label="§" href=
    "#security-considerations"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>Security and privacy are cross-cutting issues that need to
    be considered in all WoT building blocks and WoT
    implementations. This chapter summarizes some general issues
    and guidelines to help preserve the security and privacy of
    concrete WoT discovery implementations. For a more detailed and
    complete analysis of security and privacy issues, see the
    <em>WoT Security and Privacy Guidelines</em> specification
    [<cite><a class="bibref" data-link-type="biblio" href=
    "#bib-wot-security" title=
    "Web of Things (WoT) Security and Privacy Guidelines">WOT-SECURITY</a></cite>].</p>
    <p>The WoT discovery architecture is designed to avoid a
    dependence on the security and privacy of existing discovery
    schemes by using a two-phase approach and requiring
    authorization before metadata release. However several security
    and privacy risks still exist. These are listed below along
    with possible mitigations. The level of risk to privacy in
    particular depends on the use case and whether there is a risk
    that information related to a person might be distributed in a
    fashion inconsistent with the privacy desires of that person.
    We distinguish the following broad classes of use case
    scenarios:</p>
    <dl>
      <dt>Institutional</dt>
      <dd>Both the Things producing metadata and the Consumers of
      that metadata are owned and controlled by an institution or
      representatives of an institution. Example: Automation in a
      factory where a control system is accessing the state of an
      assembly line in order to evaluate quality.</dd>
      <dt>Service</dt>
      <dd>The Things producing metadata are owned and controlled by
      an institution or representatives of an institution while the
      consumers are individuals. Example: driver of an electric
      vehicle accessing the TD for a charge station in order to
      check status of a charge.</dd>
      <dt>Personal</dt>
      <dd>Both the Things producing metadata and the Consumers of
      that metadata are owned and controlled by the same
      individual. Example: A smart home control system for charging
      an electric car from home-attached solar panels, both home
      and car owned by the same person.</dd>
      <dt>Personal Peer-to-Peer</dt>
      <dd>The Things producing metadata and the Consumers of that
      metadata are owned and controlled by different individuals.
      Example: A smart home control system for charging a guest's
      electric car from home-attached solar panels.</dd>
      <dt>Institutional Peer-to-Peer</dt>
      <dd>The Things producing metadata and the Consumers of that
      metadata are owned and controlled by different institutions.
      Example: A utility provides and manages power delivered to a
      factory, and the factory provides an interface for the
      utility to negotiate on-demand power usage reductions.</dd>
      <dt>Client</dt>
      <dd>The Things producing metadata are owned and controlled by
      an individual while the consumers are an institution or
      representatives of an institution. Example: A personal
      electric vehicle exposes an interface to a public charging
      station so that the charging station can evaluate the charge
      status of the vehicle.</dd>
    </dl>
    <p>All of these in fact carry privacy risks. Even in the case
    of factory automation, there is the chance that data about
    employee performance would be captured and would have to be
    managed appropriately.</p>
    <p>With these categories established, we will now discuss some
    specific risks and potential mitigations.</p>
    <section id="security-consideration-ddos">
      <h3 id="x7-1-denial-of-service"><bdi class="secno">7.1</bdi>
      Denial of Service<a class="self-link" aria-label="§" href=
      "#security-consideration-ddos"></a></h3>
      <p>Certain functions of the directory service, in particular
      search queries, may require significant resources to execute
      and this fact can be used to launch DDoS attacks against WoT
      Thing Description Directory services.</p>
      <p>This is mostly of concern in the Service scenario, where
      the metadata requester is a private individual and the
      provider is an institution. In some cases this risk may
      appear in Peer-to-Peer scenarios as well.</p>
      <dl>
        <dt>Mitigations:</dt>
        <dd>
          A WoT Thing Description Directory implementation should
          <ul>
            <li>Limit the number of queries per unit time from the
            same requestor</li>
            <li>Limit the complexity of queries (for example, the
            total length of the query expression or its depth)</li>
            <li>Use a watchdog timer to abort queries that take
            more than a certain maximum
            (implementation-configurable) amount of time.</li>
          </ul>In cases where queries are refused or aborted
          appropriate error responses should be returned.
        </dd>
      </dl>
    </section>
    <section id="security-consideration-location-tracking">
      <h3 id="x7-2-location-tracking"><bdi class="secno">7.2</bdi>
      Location Tracking<a class="self-link" aria-label="§" href=
      "#security-consideration-location-tracking"></a></h3>
      <p>A discovery service may potentially allow the approximate
      location of a person to be determined without their consent.
      This risk occurs in some specific circumstances which can be
      avoided or mitigated. It is also similar to the risk posed by
      other network services such as DHCP and DNS.</p>
      <p>For this risk to occur, there first has to be an IoT
      device that can be reliably associated with a person's
      location, such as a necessary medical device or a vehicle.
      Note that the risk only applies to personal use cases, not
      institutional ones. Secondly, the device has to be configured
      to register automatically with the nearest directory service.
      In this case, the location of the device can be inferred from
      the network range of the directory service and the location
      of the person inferred from the location of the device.</p>
      <p>There are a few variants of this:</p>
      <ul>
        <li>The TD or Thing could report actual location
        information so no inferencing by network range is
        needed;</li>
        <li>A directory could support actual search by
        location;</li>
        <li>Absence of a TD in a directory could reveal negative
        location information (e.g. if a TD times out and is removed
        from a directory, that means the device has not been
        present for a while, which could be used to infer that a
        person is NOT in a particular location, e.g. not at
        home.</li>
      </ul>
      <p>Some of these risks are shared by similar services. For
      example, DCHP automatically responds to requests for IP
      addresses on a local network, and devices typically provide
      an identifier (a MAC address) as part of this process, and
      the DHCP server maintains a registry. In theory, someone with
      access to the DHCP server in, say, a cafe, could use this
      information to track someone's phone and infer their
      location.</p>
      <dl>
        <dt>Mitigations:</dt>
        <dd>
          There are a few options to mitigate this risk:
          <ul>
            <li>Disable registration with public directories.
            Registration would still be possible with personal
            directories, for example, a home gateway, but a user
            could disable registration at other locations. This has
            the disadvantage that functionality is lost: personal
            devices cannot be discovered in public locations. This
            could be addressed by having internet-accessible
            private discovery services (e.g. the home gateway could
            provide an internet-accessible service, but with access
            control limiting use to authorized users.</li>
            <li>Rotate IDs. Using fixed IDs makes it exceptionally
            easy to track devices. This problem also occurs in DHCP
            with MAC address and there is a similar partial
            mitigation: generate new random IDs periodically. There
            are however, a few issues. First of all, other
            identification information in the TD needs to be
            hidden. For example, client IDs issued by CSPs for API
            security should be omitted from TDs if they cannot be
            easily rotated. Second, if the device rotates the ID,
            the user may still need to know the current ID to find
            the device via discovery. This can be accomplished
            however by generating new IDs using a deterministic
            cryptographic generator that is a function of the
            current time. However, note that rotating IDs alone
            does not make tracking impossible since a TD might be
            fingerprinted. Also, updating an ID might be observable
            to the owner of the directory service, who could track
            and record the updated ID. Even if the TD is deleted
            and reinserted the association could be inferred. This
            is however exactly parallel to the situation with DHCP
            and rotation of MAC addresses. In general, however,
            generating new IDs at least for each service or person
            to which a TD is supplied makes it harder to connect
            registration events at different locations and
            times.</li>
            <li>The problem of negative location inferencing can be
            mitigated by limiting access to private directories,
            for example in the home, by using access controls. If
            an attacker cannot access the service, they cannot
            retrieve information to infer location. Access rights
            provided to guests (Peer-to-Peer Personal) should be
            appropriately time-limited. Use of long time-to-live
            values may be appropriate in other cases. In addition,
            TDs should be updated in a directory only when they
            change. For example, the TD for a car may only be
            updated when new car firmware is available providing
            new services, and the time-to-live might be set at one
            month (covering most absences).</li>
            <li>When explicit location information is available,
            whether stored in a TD or available in a property,
            additional care should be taken to only share the TD
            and/or access to the device with trusted partners,
            including directories. If the TD must be shared with a
            public directory, the location information can be
            stripped.</li>
          </ul>
        </dd>
      </dl>
    </section>
  </section>
  <section id="iana-considerations" class="normative">
    <h2 id="x8-iana-considerations"><bdi class="secno">8.</bdi>
    IANA Considerations<a class="self-link" aria-label="§" href=
    "#iana-considerations"></a></h2>
    <section id="core-resource-type">
      <h3 id="x8-1-core-resource-types-registration"><bdi class=
      "secno">8.1</bdi> CoRE Resource Types Registration<a class=
      "self-link" aria-label="§" href=
      "#core-resource-type"></a></h3>
      <p>IANA will be asked to allocate the following values into
      the Resource Type (<code>rt=</code>) Link Target Attribute
      Values sub-registry of the Constrained Restful Environments
      (CoRE) Parameters registry defined in [<cite><a class=
      "bibref" data-link-type="biblio" href="#bib-rfc6690" title=
      "Constrained RESTful Environments (CoRE) Link Format">RFC6690</a></cite>].</p>
      <table>
        <thead>
          <tr>
            <th>Value</th>
            <th>Description</th>
            <th>Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>wot.thing</code></td>
            <td>Thing Description of a Thing</td>
            <td>
              [<cite><a class="bibref" data-link-type="biblio"
              href="#bib-wot-discovery" title=
              "Web of Things (WoT) Discovery">wot-discovery</a></cite>],
              <a href="#introduction-core-rd" class=
              "sec-ref">§&nbsp;<bdi class="secno">5.4</bdi> CoRE
              Link Format and CoRE Resource Directory</a>
            </td>
          </tr>
          <tr>
            <td><code>wot.directory</code></td>
            <td>
              Directory Description of a <a href=
              "#dfn-wot-thing-description-directory" class=
              "internalDFN" data-link-type="dfn" id=
              "ref-for-dfn-wot-thing-description-directory-24">Thing
              Description Directory</a>
            </td>
            <td>
              [<cite><a class="bibref" data-link-type="biblio"
              href="#bib-wot-discovery" title=
              "Web of Things (WoT) Discovery">wot-discovery</a></cite>],
              <a href="#introduction-core-rd" class=
              "sec-ref">§&nbsp;<bdi class="secno">5.4</bdi> CoRE
              Link Format and CoRE Resource Directory</a>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </section>
  <section id="changes" class="appendix">
    <h2 id="a-recent-specification-changes"><bdi class=
    "secno">A.</bdi> Recent Specification Changes<a class=
    "self-link" aria-label="§" href="#changes"></a></h2>
    <ul>
      <li>Initial draft.</li>
    </ul>
  </section>
  <section id="acknowledgements" class="appendix normative">
    <h2 id="b-acknowledgments"><bdi class="secno">B.</bdi>
    Acknowledgments<a class="self-link" aria-label="§" href=
    "#acknowledgements"></a></h2>
    <p>Many thanks to the <abbr title=
    "World Wide Web Consortium">W3C</abbr> staff and all other
    active Participants of the <abbr title=
    "World Wide Web Consortium">W3C</abbr> Web of Things Interest
    Group (WoT IG) and Working Group (WoT WG) for their support,
    technical input and suggestions that led to improvements to
    this document.</p>
  </section>
  <section id="references" class="appendix">
    <h2 id="c-references"><bdi class="secno">C.</bdi>
    References<a class="self-link" aria-label="§" href=
    "#references"></a></h2>
    <section id="normative-references">
      <h3 id="c-1-normative-references"><bdi class=
      "secno">C.1</bdi> Normative references<a class="self-link"
      aria-label="§" href="#normative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-core-rd">[CoRE-RD]</dt>
        <dd>
          <a href=
          "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26">
          <cite>CoRE Resource Directory</cite></a>. Christian
          Amsüss; Zach Shelby; Michael Koster; Carsten Bormann;
          Peter van der Stok. IETF. 2 November 2020. URL: <a href=
          "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26">
          https://tools.ietf.org/html/draft-ietf-core-resource-directory-26</a>
        </dd>
        <dt id="bib-did-core">[DID-CORE]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/did-core/"><cite>Decentralized
          Identifiers (DIDs) v1.0</cite></a>. Drummond Reed; Manu
          Sporny; Markus Sabadello; Dave Longley; Christopher
          Allen. W3C. 29 May 2021. W3C Candidate Recommendation.
          URL: <a href=
          "https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
        </dd>
        <dt id="bib-eventsource">[EVENTSOURCE]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/eventsource/"><cite>Server-Sent
          Events</cite></a>. Ian Hickson. W3C. 28 January 2021. W3C
          Recommendation. URL: <a href=
          "https://www.w3.org/TR/eventsource/">https://www.w3.org/TR/eventsource/</a>
        </dd>
        <dt id="bib-json-ld11">[JSON-LD11]</dt>
        <dd>
          <a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD
          1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin;
          Dave Longley. W3C. 16 July 2020. W3C Recommendation. URL:
          <a href=
          "https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a>
        </dd>
        <dt id="bib-rfc2119">[RFC2119]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key
          words for use in RFCs to Indicate Requirement
          Levels</cite></a>. S. Bradner. IETF. March 1997. Best
          Current Practice. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
        </dd>
        <dt id="bib-rfc2782">[RFC2782]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc2782"><cite>A
          DNS RR for specifying the location of services (DNS
          SRV)</cite></a>. A. Gulbrandsen; P. Vixie; L. Esibov.
          IETF. February 2000. Proposed Standard. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc2782">https://datatracker.ietf.org/doc/html/rfc2782</a>
        </dd>
        <dt id="bib-rfc4122">[RFC4122]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc4122"><cite>A
          Universally Unique IDentifier (UUID) URN
          Namespace</cite></a>. P. Leach; M. Mealling; R. Salz.
          IETF. July 2005. Proposed Standard. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc4122">https://datatracker.ietf.org/doc/html/rfc4122</a>
        </dd>
        <dt id="bib-rfc6690">[RFC6690]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc6690"><cite>Constrained
          RESTful Environments (CoRE) Link Format</cite></a>. Z.
          Shelby. IETF. August 2012. Proposed Standard. URL:
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc6690">https://datatracker.ietf.org/doc/html/rfc6690</a>
        </dd>
        <dt id="bib-rfc6762">[RFC6762]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc6762"><cite>Multicast
          DNS</cite></a>. S. Cheshire; M. Krochmal. IETF. February
          2013. Proposed Standard. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc6762">https://datatracker.ietf.org/doc/html/rfc6762</a>
        </dd>
        <dt id="bib-rfc6763">[RFC6763]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc6763"><cite>DNS-Based
          Service Discovery</cite></a>. S. Cheshire; M. Krochmal.
          IETF. February 2013. Proposed Standard. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc6763">https://datatracker.ietf.org/doc/html/rfc6763</a>
        </dd>
        <dt id="bib-rfc7230">[RFC7230]</dt>
        <dd>
          <a href=
          "https://httpwg.org/specs/rfc7230.html"><cite>Hypertext
          Transfer Protocol (HTTP/1.1): Message Syntax and
          Routing</cite></a>. R. Fielding, Ed.; J. Reschke, Ed..
          IETF. June 2014. Proposed Standard. URL: <a href=
          "https://httpwg.org/specs/rfc7230.html">https://httpwg.org/specs/rfc7230.html</a>
        </dd>
        <dt id="bib-rfc7231">[RFC7231]</dt>
        <dd>
          <a href=
          "https://httpwg.org/specs/rfc7231.html"><cite>Hypertext
          Transfer Protocol (HTTP/1.1): Semantics and
          Content</cite></a>. R. Fielding, Ed.; J. Reschke, Ed..
          IETF. June 2014. Proposed Standard. URL: <a href=
          "https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a>
        </dd>
        <dt id="bib-rfc7396">[RFC7396]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc7396"><cite>JSON
          Merge Patch</cite></a>. P. Hoffman; J. Snell. IETF.
          October 2014. Proposed Standard. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc7396">https://datatracker.ietf.org/doc/html/rfc7396</a>
        </dd>
        <dt id="bib-rfc7540">[RFC7540]</dt>
        <dd>
          <a href=
          "https://httpwg.org/specs/rfc7540.html"><cite>Hypertext
          Transfer Protocol Version 2 (HTTP/2)</cite></a>. M.
          Belshe; R. Peon; M. Thomson, Ed.. IETF. May 2015.
          Proposed Standard. URL: <a href=
          "https://httpwg.org/specs/rfc7540.html">https://httpwg.org/specs/rfc7540.html</a>
        </dd>
        <dt id="bib-rfc7807">[RFC7807]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc7807"><cite>Problem
          Details for HTTP APIs</cite></a>. M. Nottingham; E.
          Wilde. IETF. March 2016. Proposed Standard. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc7807">https://datatracker.ietf.org/doc/html/rfc7807</a>
        </dd>
        <dt id="bib-rfc8174">[RFC8174]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc8174"><cite>Ambiguity
          of Uppercase vs Lowercase in RFC 2119 Key
          Words</cite></a>. B. Leiba. IETF. May 2017. Best Current
          Practice. URL: <a href=
          "https://datatracker.ietf.org/doc/html/rfc8174">https://datatracker.ietf.org/doc/html/rfc8174</a>
        </dd>
        <dt id="bib-rfc8615">[RFC8615]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc8615"><cite>Well-Known
          Uniform Resource Identifiers (URIs)</cite></a>. M.
          Nottingham. IETF. May 2019. Proposed Standard. URL:
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc8615">https://datatracker.ietf.org/doc/html/rfc8615</a>
        </dd>
        <dt id="bib-sparql11-overview">[SPARQL11-OVERVIEW]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/sparql11-overview/"><cite>SPARQL
          1.1 Overview</cite></a>. The W3C SPARQL Working Group.
          W3C. 21 March 2013. W3C Recommendation. URL: <a href=
          "https://www.w3.org/TR/sparql11-overview/">https://www.w3.org/TR/sparql11-overview/</a>
        </dd>
        <dt id="bib-wot-architecture">[wot-architecture]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/wot-architecture/"><cite>Web of
          Things (WoT) Architecture</cite></a>. Matthias Kovatsch;
          Ryuichi Matsukura; Michael Lagally; Toru Kawaguchi;
          Kunihiko Toumura; Kazuo Kajimoto. W3C. 9 April 2020. W3C
          Recommendation. URL: <a href=
          "https://www.w3.org/TR/wot-architecture/">https://www.w3.org/TR/wot-architecture/</a>
        </dd>
        <dt id="bib-wot-discovery">[wot-discovery]</dt>
        <dd>
          <a href="https://www.w3.org/TR/wot-discovery/"><cite>Web
          of Things (WoT) Discovery</cite></a>. Andrea Cimmino;
          Michael McCool; Farshid Tavakolizadeh; Kunihiko Toumura.
          W3C. 24 November 2020. W3C Working Draft. URL: <a href=
          "https://www.w3.org/TR/wot-discovery/">https://www.w3.org/TR/wot-discovery/</a>
        </dd>
        <dt id="bib-wot-thing-description">
        [wot-thing-description]</dt>
        <dd>
          <a href=
          "https://www.w3.org/TR/wot-thing-description/"><cite>Web
          of Things (WoT) Thing Description</cite></a>. Sebastian
          Käbisch; Takuki Kamiya; Michael McCool; Victor Charpenay;
          Matthias Kovatsch. W3C. 9 April 2020. W3C Recommendation.
          URL: <a href=
          "https://www.w3.org/TR/wot-thing-description/">https://www.w3.org/TR/wot-thing-description/</a>
        </dd>
        <dt id="bib-wot-usecases">[wot-usecases]</dt>
        <dd>
          <a href="https://w3c.github.io/wot-usecases/"><cite>Web
          of Things (WoT): Use Cases</cite></a>. Michael Lagally;
          Michael McCool; Ryuichi Matsukura; Tomoaki Mizushima.
          W3C. 15 October 2020. Editor's Draft. URL: <a href=
          "https://w3c.github.io/wot-usecases/">https://w3c.github.io/wot-usecases/</a>
        </dd>
        <dt id="bib-xpath-31">[xpath-31]</dt>
        <dd>
          <a href="https://www.w3.org/TR/xpath-31/"><cite>XML Path
          Language (XPath) 3.1</cite></a>. Jonathan Robie; Michael
          Dyck; Josh Spiegel. W3C. 21 March 2017. W3C
          Recommendation. URL: <a href=
          "https://www.w3.org/TR/xpath-31/">https://www.w3.org/TR/xpath-31/</a>
        </dd>
      </dl>
    </section>
    <section id="informative-references">
      <h3 id="c-2-informative-references"><bdi class=
      "secno">C.2</bdi> Informative references<a class="self-link"
      aria-label="§" href="#informative-references"></a></h3>
      <dl class="bibliography">
        <dt id="bib-jsonpath">[JSONPATH]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00">
          <cite>JavaScript Object Notation (JSON) Path</cite></a>.
          Glyn Normington; Edward Surov; Marko Mikulicic; Stefan
          Gössner. IETF. 7 March 2021. DRAFT. URL: <a href=
          "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00">
          https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00</a>
        </dd>
        <dt id="bib-rest-iot">[REST-IOT]</dt>
        <dd>
          <a href=
          "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06">
          <cite>RESTful Design for Internet of Things
          Systems</cite></a>. Ari Keranen; Matthias Kovatsch; Klaus
          Hartke. IETF. 11 May 2020. URL: <a href=
          "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06">
          https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06</a>
        </dd>
        <dt id="bib-rfc8552">[RFC8552]</dt>
        <dd>
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc8552"><cite>Scoped
          Interpretation of DNS Resource Records through
          "Underscored" Naming of Attribute Leaves</cite></a>. D.
          Crocker. IETF. March 2019. Best Current Practice. URL:
          <a href=
          "https://datatracker.ietf.org/doc/html/rfc8552">https://datatracker.ietf.org/doc/html/rfc8552</a>
        </dd>
        <dt id="bib-wot-security">[WOT-SECURITY]</dt>
        <dd>
          <a href="https://www.w3.org/TR/wot-security/"><cite>Web
          of Things (WoT) Security and Privacy
          Guidelines</cite></a>. Elena Reshetova; Michael McCool.
          W3C. 6 November 2019. W3C Note. URL: <a href=
          "https://www.w3.org/TR/wot-security/">https://www.w3.org/TR/wot-security/</a>
        </dd>
      </dl>
    </section>
  </section>
  <p role="navigation" id="back-to-top"><a href=
  "#title"><abbr title="Back to Top">↑</abbr></a></p>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-thing" aria-label=
  "Links in this document to definition: Thing">
    <div>
      <a class="self-link" href="#dfn-thing" aria-label=
      "Permalink for definition: Thing. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>
        <a href="#ref-for-dfn-thing-1" title=
        "§ 6.1 Self-description">§ 6.1 Self-description</a>
      </li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-thing-description" aria-label=
  "Links in this document to definition: Thing Description">
    <div>
      <a class="self-link" href="#dfn-thing-description"
      aria-label="Permalink for definition: Thing Description. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-td" aria-label=
  "Links in this document to definition: TD">
    <div>
      <a class="self-link" href="#dfn-td" aria-label=
      "Permalink for definition: TD. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>
        <a href="#ref-for-dfn-td-1" title=
        "§ 6.1 Self-description">§ 6.1 Self-description</a>
      </li>
      <li>
        <a href="#ref-for-dfn-td-2" title="§ 6.2 Directory">§ 6.2
        Directory</a> <a href="#ref-for-dfn-td-3" title=
        "Reference 2">(2)</a> <a href="#ref-for-dfn-td-4" title=
        "Reference 3">(3)</a>
      </li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-property" aria-label=
  "Links in this document to definition: Property">
    <div>
      <a class="self-link" href="#dfn-property" aria-label=
      "Permalink for definition: Property. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-action" aria-label=
  "Links in this document to definition: Action">
    <div>
      <a class="self-link" href="#dfn-action" aria-label=
      "Permalink for definition: Action. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-event" aria-label=
  "Links in this document to definition: Event">
    <div>
      <a class="self-link" href="#dfn-event" aria-label=
      "Permalink for definition: Event. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-anonymous-thing-description"
  aria-label="Links in this document to definition: Anonymous TD">
    <div>
      <a class="self-link" href=
      "#dfn-wot-anonymous-thing-description" aria-label=
      "Permalink for definition: Anonymous TD. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-anonymous-thing-description-1"
        title="§ 6.2.2.1.1 Creation">§ 6.2.2.1.1 Creation</a>
        <a href="#ref-for-dfn-wot-anonymous-thing-description-2"
        title="Reference 2">(2)</a>
      </li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-discovery" aria-label=
  "Links in this document to definition: Discovery">
    <div>
      <a class="self-link" href="#dfn-wot-discovery" aria-label=
      "Permalink for definition: Discovery. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-enriched-thing-description" aria-label=
  "Links in this document to definition: Enriched TD">
    <div>
      <a class="self-link" href=
      "#dfn-wot-enriched-thing-description" aria-label=
      "Permalink for definition: Enriched TD. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-enriched-thing-description-1"
        title="§ 6.2 Directory">§ 6.2 Directory</a>
      </li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-exploration" aria-label=
  "Links in this document to definition: Exploration">
    <div>
      <a class="self-link" href="#dfn-wot-exploration" aria-label=
      "Permalink for definition: Exploration. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-introduction" aria-label=
  "Links in this document to definition: Introduction">
    <div>
      <a class="self-link" href="#dfn-wot-introduction" aria-label=
      "Permalink for definition: Introduction. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-tdd" aria-label=
  "Links in this document to definition: TDD">
    <div>
      <a class="self-link" href="#dfn-wot-tdd" aria-label=
      "Permalink for definition: TDD. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>Not referenced in this document.</li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-thing-description-directory"
  aria-label="Links in this document to definition: Thing Description Directory">
    <div>
      <a class="self-link" href=
      "#dfn-wot-thing-description-directory" aria-label=
      "Permalink for definition: Thing Description Directory. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-1"
        title="§ 5. Introduction Mechanisms">§ 5. Introduction
        Mechanisms</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-2" title=
        "Reference 2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-3"
        title="§ 5.1 Direct">§ 5.1 Direct</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-4" title=
        "Reference 2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-5"
        title="§ 5.2 Well-Known URIs">§ 5.2 Well-Known URIs</a>
        <a href="#ref-for-dfn-wot-thing-description-directory-6"
        title="Reference 2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-7"
        title="§ 5.3 DNS-Based Service Discovery">§ 5.3 DNS-Based
        Service Discovery</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-8" title=
        "Reference 2">(2)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-9" title=
        "Reference 3">(3)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-10" title=
        "Reference 4">(4)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-11" title=
        "Reference 5">(5)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-12" title=
        "Reference 6">(6)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-13" title=
        "Reference 7">(7)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-14"
        title=
        "§ 5.4 CoRE Link Format and CoRE Resource Directory">§ 5.4
        CoRE Link Format and CoRE Resource Directory</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-15" title=
        "Reference 2">(2)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-16" title=
        "Reference 3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-17"
        title="§ 5.5 DID Documents">§ 5.5 DID Documents</a>
        <a href="#ref-for-dfn-wot-thing-description-directory-18"
        title="Reference 2">(2)</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-19" title=
        "Reference 3">(3)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-20"
        title="§ 6. Exploration Mechanisms">§ 6. Exploration
        Mechanisms</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-21"
        title="§ 6.1 Self-description">§ 6.1 Self-description</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-22"
        title="§ 6.2 Directory">§ 6.2 Directory</a> <a href=
        "#ref-for-dfn-wot-thing-description-directory-23" title=
        "Reference 2">(2)</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-thing-description-directory-24"
        title="§ 8.1 CoRE Resource Types Registration">§ 8.1 CoRE
        Resource Types Registration</a>
      </li>
    </ul>
  </div>
  <div class="dfn-panel" hidden="" role="dialog" aria-modal="true"
  id="dfn-panel-for-dfn-wot-partial-thing-description" aria-label=
  "Links in this document to definition: Partial TD">
    <div>
      <a class="self-link" href=
      "#dfn-wot-partial-thing-description" aria-label=
      "Permalink for definition: Partial TD. Activate to close this dialog.">
      Permalink</a>
    </div>
    <p><b>Referenced in:</b></p>
    <ul>
      <li>
        <a href="#ref-for-dfn-wot-partial-thing-description-1"
        title="§ 6.2.2.1.3 Update">§ 6.2.2.1.3 Update</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-partial-thing-description-2"
        title="§ 6.2.2.1.5 Listing">§ 6.2.2.1.5 Listing</a>
      </li>
      <li>
        <a href="#ref-for-dfn-wot-partial-thing-description-3"
        title="§ 6.2.2.3 Notification">§ 6.2.2.3 Notification</a>
      </li>
    </ul>
  </div>
  <script id="respec-dfn-panel">
  (() => {
  // @ts-check
  if (document.respec) {
  document.respec.ready.then(setupPanel);
  } else {
  setupPanel();
  }

  function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
  }

  function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
  }

  /**
  * @param {MouseEvent|KeyboardEvent} event
  */
  function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
  }

  /**
  * @param {Event} event
  */
  function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
  }

  /**
  * @param {HTMLElement} dfn
  * @param {HTMLElement} panel
  * @param {{ x: number, y: number }} clickPosition
  */
  function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
  }

  /**
  * @param {HTMLElement} panel
  * @param {HTMLElement} dfn
  * @returns
  */
  function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
  }

  /**
  *
  * @param {NodeListOf<HTMLAnchorElement>} anchors
  * @param {HTMLElement} panel
  * @param {HTMLElement} dfn
  * @returns
  */
  function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
  }

  /** @param {HTMLElement} panel */
  function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
  }
  })()
  </script>
  <script src=
  "https://www.w3.org/scripts/TR/2016/fixup.js"></script>
</body>
</html>
